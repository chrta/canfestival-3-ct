<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CanFestival: /home/epimerde/documents/tc11/CanFestival-3/objdictgen/networkedit.py Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>/home/epimerde/documents/tc11/CanFestival-3/objdictgen/networkedit.py</h1><a href="networkedit_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacenetworkedit.html">00001</a> <span class="comment">#!/usr/bin/env python</span>
<a name="l00002"></a>00002 <span class="comment"># -*- coding: utf-8 -*-</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="comment">#This file is part of CanFestival, a library implementing CanOpen Stack. </span>
<a name="l00005"></a>00005 <span class="comment">#</span>
<a name="l00006"></a>00006 <span class="comment">#Copyright (C): Edouard TISSERANT, Francis DUPIN and Laurent BESSARD</span>
<a name="l00007"></a>00007 <span class="comment">#</span>
<a name="l00008"></a>00008 <span class="comment">#See COPYING file for copyrights details.</span>
<a name="l00009"></a>00009 <span class="comment">#</span>
<a name="l00010"></a>00010 <span class="comment">#This library is free software; you can redistribute it and/or</span>
<a name="l00011"></a>00011 <span class="comment">#modify it under the terms of the GNU Lesser General Public</span>
<a name="l00012"></a>00012 <span class="comment">#License as published by the Free Software Foundation; either</span>
<a name="l00013"></a>00013 <span class="comment">#version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00014"></a>00014 <span class="comment">#</span>
<a name="l00015"></a>00015 <span class="comment">#This library is distributed in the hope that it will be useful,</span>
<a name="l00016"></a>00016 <span class="comment">#but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00017"></a>00017 <span class="comment">#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00018"></a>00018 <span class="comment">#Lesser General Public License for more details.</span>
<a name="l00019"></a>00019 <span class="comment">#</span>
<a name="l00020"></a>00020 <span class="comment">#You should have received a copy of the GNU Lesser General Public</span>
<a name="l00021"></a>00021 <span class="comment">#License along with this library; if not, write to the Free Software</span>
<a name="l00022"></a>00022 <span class="comment">#Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="keyword">from</span> wxPython.wx <span class="keyword">import</span> *
<a name="l00025"></a>00025 <span class="keyword">from</span> wxPython.grid <span class="keyword">import</span> *
<a name="l00026"></a>00026 <span class="keyword">import</span> wx
<a name="l00027"></a>00027 <span class="keyword">from</span> wx.lib.anchors <span class="keyword">import</span> LayoutAnchors
<a name="l00028"></a>00028 <span class="keyword">import</span> wx.grid
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">from</span> types <span class="keyword">import</span> *
<a name="l00031"></a>00031 <span class="keyword">import</span> os, re, platform, sys, time, traceback, getopt
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 __version__ = <span class="stringliteral">"$Revision$"</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="keyword">from</span> nodelist <span class="keyword">import</span> *
<a name="l00036"></a>00036 <span class="keyword">from</span> nodemanager <span class="keyword">import</span> *
<a name="l00037"></a>00037 <span class="keyword">from</span> subindextable <span class="keyword">import</span> *
<a name="l00038"></a>00038 <span class="keyword">from</span> commondialogs <span class="keyword">import</span> *
<a name="l00039"></a>00039 <span class="keyword">from</span> doc_index.DS301_index <span class="keyword">import</span> *
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="namespacenetworkedit.html#dda6cbf16074f4596324bd8c75e7a409">00041</a> <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#dda6cbf16074f4596324bd8c75e7a409">create</a>(parent):
<a name="l00042"></a>00042     <span class="keywordflow">return</span> networkedit(parent)
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="namespacenetworkedit.html#d1c96437c6338056898af5f7119a2a7c">00044</a> <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#d1c96437c6338056898af5f7119a2a7c">usage</a>():
<a name="l00045"></a>00045     <span class="keywordflow">print</span> <span class="stringliteral">"\nUsage of networkedit.py :"</span>
<a name="l00046"></a>00046     <span class="keywordflow">print</span> <span class="stringliteral">"\n   %s [Projectpath]\n"</span>%sys.argv[0]
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="keywordflow">try</span>:
<a name="l00049"></a>00049     opts, args = getopt.getopt(sys.argv[1:], <span class="stringliteral">"h"</span>, [<span class="stringliteral">"help"</span>])
<a name="l00050"></a>00050 <span class="keywordflow">except</span> getopt.GetoptError:
<a name="l00051"></a>00051     <span class="comment"># print help information and exit:</span>
<a name="l00052"></a>00052     usage()
<a name="l00053"></a>00053     sys.exit(2)
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="keywordflow">for</span> o, a <span class="keywordflow">in</span> opts:
<a name="l00056"></a>00056     <span class="keywordflow">if</span> o <span class="keywordflow">in</span> (<span class="stringliteral">"-h"</span>, <span class="stringliteral">"--help"</span>):
<a name="l00057"></a>00057         usage()
<a name="l00058"></a>00058         sys.exit()
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="keywordflow">if</span> len(args) == 0:
<a name="l00061"></a>00061     projectOpen = <span class="keywordtype">None</span> 
<a name="l00062"></a>00062 <span class="keywordflow">elif</span> len(args) == 1:
<a name="l00063"></a>00063     projectOpen = args[0]
<a name="l00064"></a>00064 <span class="keywordflow">else</span>:
<a name="l00065"></a>00065     usage()
<a name="l00066"></a>00066     sys.exit(2)
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 ScriptDirectory = sys.path[0]
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="keywordflow">try</span>:
<a name="l00071"></a>00071     <span class="keyword">from</span> wxPython.html <span class="keyword">import</span> *
<a name="l00072"></a>00072 
<a name="l00073"></a>00073     wxEVT_HTML_URL_CLICK = wxNewId()
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="namespacenetworkedit.html#f4d85792fc654e45170911a58483376e">00075</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#f4d85792fc654e45170911a58483376e">EVT_HTML_URL_CLICK</a>(win, func):
<a name="l00076"></a>00076         win.Connect(-1, -1, wxEVT_HTML_URL_CLICK, func)
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="classnetworkedit_1_1wxHtmlWindowUrlClick.html">00078</a>     <span class="keyword">class </span><a class="code" href="classnetworkedit_1_1wxHtmlWindowUrlClick.html">wxHtmlWindowUrlClick</a>(wxPyEvent):
<a name="l00079"></a><a class="code" href="classnetworkedit_1_1wxHtmlWindowUrlClick.html#25827ced9049e3981080101f2ec13bb4">00079</a>         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxHtmlWindowUrlClick.html#25827ced9049e3981080101f2ec13bb4">__init__</a>(self, linkinfo):
<a name="l00080"></a>00080             wxPyEvent.__init__(self)
<a name="l00081"></a>00081             self.SetEventType(wxEVT_HTML_URL_CLICK)
<a name="l00082"></a><a class="code" href="classnetworkedit_1_1wxHtmlWindowUrlClick.html#8c1f6a4da431940a09972f01c45d015a">00082</a>             self.<a class="code" href="classnetworkedit_1_1wxHtmlWindowUrlClick.html#8c1f6a4da431940a09972f01c45d015a">linkinfo</a>linkinfo = (linkinfo.GetHref(), linkinfo.GetTarget())
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow.html">00084</a>     <span class="keyword">class </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow.html">wxUrlClickHtmlWindow</a>(wxHtmlWindow):
<a name="l00085"></a>00085         <span class="stringliteral">""" HTML window that generates and OnLinkClicked event.</span>
<a name="l00086"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow.html#5771c9faa8f337f6a279ac395a31f037">00086</a> <span class="stringliteral"></span>
<a name="l00087"></a>00087 <span class="stringliteral">        Use this to avoid having to override HTMLWindow</span>
<a name="l00088"></a>00088 <span class="stringliteral">        """</span>
<a name="l00089"></a>00089         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow.html#5771c9faa8f337f6a279ac395a31f037">OnLinkClicked</a>(self, linkinfo):
<a name="l00090"></a>00090             wxPostEvent(self, wxHtmlWindowUrlClick(linkinfo))
<a name="l00091"></a>00091     
<a name="l00092"></a>00092 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00093"></a>00093 <span class="comment">#                                Html Frame</span>
<a name="l00094"></a>00094 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00095"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html">00095</a> 
<a name="l00096"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#2930185c7e28e2386998fba908fde7c8">00096</a>     [wxID_HTMLFRAME, wxID_HTMLFRAMEHTMLCONTENT] = [wx.NewId() <span class="keywordflow">for</span> _init_ctrls <span class="keywordflow">in</span> range(2)]
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <span class="keyword">class </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html">HtmlFrame</a>(wx.Frame):
<a name="l00099"></a>00099         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#2930185c7e28e2386998fba908fde7c8">_init_ctrls</a>(self, prnt):
<a name="l00100"></a>00100             <span class="comment"># generated method, don't edit</span>
<a name="l00101"></a>00101             wx.Frame.__init__(self, id=wxID_HTMLFRAME, name=<span class="stringliteral">'HtmlFrame'</span>,
<a name="l00102"></a>00102                   parent=prnt, pos=wx.Point(320, 231), size=wx.Size(853, 616),
<a name="l00103"></a>00103                   style=wx.DEFAULT_FRAME_STYLE, title=<span class="stringliteral">''</span>)
<a name="l00104"></a>00104             self.Bind(wx.EVT_CLOSE, self.<a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#300490430ca9c68ffff6f1ce4f9cff66">OnCloseFrame</a>OnCloseFrame, id=wxID_HTMLFRAME)
<a name="l00105"></a>00105             
<a name="l00106"></a>00106             self.HtmlContent = wxUrlClickHtmlWindow(id=wxID_HTMLFRAMEHTMLCONTENT,
<a name="l00107"></a>00107                   name=<span class="stringliteral">'HtmlContent'</span>, parent=self, pos=wx.Point(0, 0),
<a name="l00108"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#84dbbfa164b9bfc3867064ef8ddc825c">00108</a>                   size=wx.Size(-1, -1), style=wxHW_SCROLLBAR_AUTO|wxHW_NO_SELECTION)
<a name="l00109"></a>00109             EVT_HTML_URL_CLICK(self.HtmlContent, self.<a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#efef756beaf2cecc502b2f6c3c5386cb">OnLinkClick</a>OnLinkClick)
<a name="l00110"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#14f29033b3eec5b120495b5c24050939">00110</a> 
<a name="l00111"></a>00111         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#84dbbfa164b9bfc3867064ef8ddc825c">__init__</a>(self, parent, opened):
<a name="l00112"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#0d46d44545dff5c49ee702dce0ca58a7">00112</a>             self.<a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#2930185c7e28e2386998fba908fde7c8">_init_ctrls</a>_init_ctrls(parent)
<a name="l00113"></a>00113             self.<a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#14f29033b3eec5b120495b5c24050939">HtmlFrameOpened</a>HtmlFrameOpened = opened
<a name="l00114"></a>00114         
<a name="l00115"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#4facc9fa00032db7ca18302a09300a15">00115</a>         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#0d46d44545dff5c49ee702dce0ca58a7">SetHtmlCode</a>(self, htmlcode):
<a name="l00116"></a>00116             self.HtmlContent.SetPage(htmlcode)
<a name="l00117"></a>00117             
<a name="l00118"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#300490430ca9c68ffff6f1ce4f9cff66">00118</a>         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#4facc9fa00032db7ca18302a09300a15">SetHtmlPage</a>(self, htmlpage):
<a name="l00119"></a>00119             self.HtmlContent.LoadPage(htmlpage)
<a name="l00120"></a>00120             
<a name="l00121"></a>00121         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#300490430ca9c68ffff6f1ce4f9cff66">OnCloseFrame</a>(self, event):
<a name="l00122"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#efef756beaf2cecc502b2f6c3c5386cb">00122</a>             self.<a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#14f29033b3eec5b120495b5c24050939">HtmlFrameOpened</a>HtmlFrameOpened.remove(self.GetTitle())
<a name="l00123"></a>00123             event.Skip()
<a name="l00124"></a>00124         
<a name="l00125"></a>00125         <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#efef756beaf2cecc502b2f6c3c5386cb">OnLinkClick</a>(self, event):
<a name="l00126"></a>00126             url = event.linkinfo[0]
<a name="l00127"></a>00127             <span class="keywordflow">try</span>:
<a name="l00128"></a>00128                 <span class="keyword">import</span> webbrowser
<a name="l00129"></a>00129             <span class="keywordflow">except</span> ImportError:
<a name="l00130"></a>00130                 wxMessageBox(<span class="stringliteral">'Please point your browser at: %s'</span> % url)
<a name="l00131"></a><a class="code" href="classnetworkedit_1_1wxUrlClickHtmlWindow.html#afbd518c3d5d17bfd1e0241e77f26c27">00131</a>             <span class="keywordflow">else</span>:
<a name="l00132"></a>00132                 webbrowser.open(url)
<a name="l00133"></a>00133     
<a name="l00134"></a>00134     Html_Window = <span class="keyword">True</span>
<a name="l00135"></a>00135 <span class="keywordflow">except</span>:
<a name="l00136"></a>00136     Html_Window = <span class="keyword">False</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 [wxID_NETWORKEDIT, wxID_NETWORKEDITNETWORKNODES, 
<a name="l00140"></a>00140  wxID_NETWORKEDITHELPBAR,
<a name="l00141"></a>00141 ] = [wx.NewId() <span class="keywordflow">for</span> _init_ctrls <span class="keywordflow">in</span> range(3)]
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 [wxID_NETWORKEDITADDMENUITEMS0, wxID_NETWORKEDITADDMENUITEMS1, 
<a name="l00144"></a>00144  wxID_NETWORKEDITADDMENUITEMS2, wxID_NETWORKEDITADDMENUITEMS3, 
<a name="l00145"></a>00145  wxID_NETWORKEDITADDMENUITEMS4, wxID_NETWORKEDITADDMENUITEMS5, 
<a name="l00146"></a>00146 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_AddMenu_Items <span class="keywordflow">in</span> range(6)]
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 [wxID_NETWORKEDITFILEMENUITEMS0, wxID_NETWORKEDITFILEMENUITEMS1, 
<a name="l00149"></a>00149  wxID_NETWORKEDITFILEMENUITEMS2, wxID_NETWORKEDITFILEMENUITEMS4, 
<a name="l00150"></a>00150  wxID_NETWORKEDITFILEMENUITEMS5, wxID_NETWORKEDITFILEMENUITEMS6,
<a name="l00151"></a>00151 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_FileMenu_Items <span class="keywordflow">in</span> range(6)]
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 [wxID_NETWORKEDITNETWORKMENUITEMS0, wxID_NETWORKEDITNETWORKMENUITEMS1, 
<a name="l00154"></a>00154  wxID_NETWORKEDITNETWORKMENUITEMS3, 
<a name="l00155"></a>00155 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_AddMenu_Items <span class="keywordflow">in</span> range(3)]
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 [wxID_NETWORKEDITEDITMENUITEMS0, wxID_NETWORKEDITEDITMENUITEMS1, 
<a name="l00159"></a>00159  wxID_NETWORKEDITEDITMENUITEMS2, wxID_NETWORKEDITEDITMENUITEMS4, 
<a name="l00160"></a>00160  wxID_NETWORKEDITEDITMENUITEMS6, wxID_NETWORKEDITEDITMENUITEMS7, 
<a name="l00161"></a>00161  wxID_NETWORKEDITEDITMENUITEMS8, 
<a name="l00162"></a>00162 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_EditMenu_Items <span class="keywordflow">in</span> range(7)]
<a name="l00163"></a>00163 
<a name="l00164"></a>00164 [wxID_NETWORKEDITHELPMENUITEMS0, wxID_NETWORKEDITHELPMENUITEMS1,
<a name="l00165"></a>00165  wxID_NETWORKEDITHELPMENUITEMS2,
<a name="l00166"></a>00166 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_HelpMenu_Items <span class="keywordflow">in</span> range(3)]
<a name="l00167"></a>00167 
<a name="l00168"></a><a class="code" href="classnetworkedit_1_1networkedit.html">00168</a> <span class="keyword">class </span><a class="code" href="classnetworkedit_1_1networkedit.html">networkedit</a>(wx.Frame):
<a name="l00169"></a><a class="code" href="classnetworkedit_1_1networkedit.html#d77fb9e0e648f4c8293fb0477cd2a21b">00169</a>     <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1networkedit.html#d77fb9e0e648f4c8293fb0477cd2a21b">_init_coll_menuBar1_Menus</a>(self, parent):
<a name="l00170"></a>00170         <span class="comment"># generated method, don't edit</span>
<a name="l00171"></a>00171 
<a name="l00172"></a>00172         <span class="keywordflow">if</span> self.Mode == <span class="stringliteral">"solo"</span>:
<a name="l00173"></a>00173             parent.Append(menu=self.FileMenu, title=<span class="stringliteral">'File'</span>)
<a name="l00174"></a>00174         parent.Append(menu=self.NetworkMenu, title=<span class="stringliteral">'Network'</span>)
<a name="l00175"></a>00175         parent.Append(menu=self.EditMenu, title=<span class="stringliteral">'Edit'</span>)
<a name="l00176"></a>00176         parent.Append(menu=self.AddMenu, title=<span class="stringliteral">'Add'</span>)
<a name="l00177"></a>00177         parent.Append(menu=self.HelpMenu, title=<span class="stringliteral">'Help'</span>)
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="classnetworkedit_1_1networkedit.html#25c016ab06d767eba51087786081afdc">00179</a>     <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1networkedit.html#25c016ab06d767eba51087786081afdc">_init_coll_EditMenu_Items</a>(self, parent):
<a name="l00180"></a>00180         <span class="comment"># generated method, don't edit</span>
<a name="l00181"></a>00181 
<a name="l00182"></a>00182         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITEDITMENUITEMS4,
<a name="l00183"></a>00183               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Refresh\tCTRL+R'</span>)
<a name="l00184"></a>00184         parent.AppendSeparator()
<a name="l00185"></a>00185         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITEDITMENUITEMS1,
<a name="l00186"></a>00186               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Undo\tCTRL+Z'</span>)
<a name="l00187"></a>00187         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITEDITMENUITEMS0,
<a name="l00188"></a>00188               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Redo\tCTRL+Y'</span>)
<a name="l00189"></a>00189         parent.AppendSeparator()
<a name="l00190"></a>00190         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITEDITMENUITEMS6,
<a name="l00191"></a>00191               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Node infos'</span>)
<a name="l00192"></a>00192         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITEDITMENUITEMS2,
<a name="l00193"></a>00193               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'DS-301 Profile'</span>)
<a name="l00194"></a>00194         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITEDITMENUITEMS8,
<a name="l00195"></a>00195               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'DS-302 Profile'</span>)
<a name="l00196"></a>00196         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITEDITMENUITEMS7,
<a name="l00197"></a>00197               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Other Profile'</span>)
<a name="l00198"></a>00198         self.Bind(wx.EVT_MENU, self.OnUndoMenu,
<a name="l00199"></a>00199               id=wxID_NETWORKEDITEDITMENUITEMS1)
<a name="l00200"></a>00200         self.Bind(wx.EVT_MENU, self.OnRedoMenu,
<a name="l00201"></a>00201               id=wxID_NETWORKEDITEDITMENUITEMS0)
<a name="l00202"></a>00202         self.Bind(wx.EVT_MENU, self.OnCommunicationMenu,
<a name="l00203"></a>00203               id=wxID_NETWORKEDITEDITMENUITEMS2)
<a name="l00204"></a>00204         self.Bind(wx.EVT_MENU, self.OnRefreshMenu,
<a name="l00205"></a>00205               id=wxID_NETWORKEDITEDITMENUITEMS4)
<a name="l00206"></a>00206         self.Bind(wx.EVT_MENU, self.OnNodeInfosMenu,
<a name="l00207"></a>00207               id=wxID_NETWORKEDITEDITMENUITEMS6)
<a name="l00208"></a>00208         self.Bind(wx.EVT_MENU, self.OnEditProfileMenu,
<a name="l00209"></a>00209               id=wxID_NETWORKEDITEDITMENUITEMS7)
<a name="l00210"></a>00210         self.Bind(wx.EVT_MENU, self.OnOtherCommunicationMenu,
<a name="l00211"></a>00211               id=wxID_NETWORKEDITEDITMENUITEMS8)
<a name="l00212"></a>00212 
<a name="l00213"></a><a class="code" href="classnetworkedit_1_1networkedit.html#eff9fade803f4b7a384ee62c83d70390">00213</a>     <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1networkedit.html#eff9fade803f4b7a384ee62c83d70390">_init_coll_HelpMenu_Items</a>(self, parent):
<a name="l00214"></a>00214         <span class="comment"># generated method, don't edit</span>
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITHELPMENUITEMS0,
<a name="l00217"></a>00217               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'DS-301 Standard\tF1'</span>)
<a name="l00218"></a>00218         self.Bind(wx.EVT_MENU, self.OnHelpDS301Menu,
<a name="l00219"></a>00219               id=wxID_NETWORKEDITHELPMENUITEMS0)
<a name="l00220"></a>00220         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITHELPMENUITEMS1,
<a name="l00221"></a>00221               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'CAN Festival Docs\tF2'</span>)
<a name="l00222"></a>00222         self.Bind(wx.EVT_MENU, self.OnHelpCANFestivalMenu,
<a name="l00223"></a>00223               id=wxID_NETWORKEDITHELPMENUITEMS1)
<a name="l00224"></a>00224         <span class="keywordflow">if</span> Html_Window <span class="keywordflow">and</span> self.Mode == <span class="stringliteral">"solo"</span>:
<a name="l00225"></a>00225             parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITHELPMENUITEMS2,
<a name="l00226"></a>00226                   kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'About'</span>)
<a name="l00227"></a>00227             self.Bind(wx.EVT_MENU, self.OnAboutMenu,
<a name="l00228"></a>00228                   id=wxID_NETWORKEDITHELPMENUITEMS2)
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="classnetworkedit_1_1networkedit.html#819560a4debaf28d7a1837c1fe68212b">00230</a>     <span class="keyword">def </span><a class="code" href="classnetworkedit_1_1networkedit.html#819560a4debaf28d7a1837c1fe68212b">_init_coll_FileMenu_Items</a>(self, parent):
<a name="l00231"></a>00231         <span class="comment"># generated method, don't edit</span>
<a name="l00232"></a>00232 
<a name="l00233"></a>00233         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITFILEMENUITEMS5,
<a name="l00234"></a>00234               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'New\tCTRL+N'</span>)
<a name="l00235"></a>00235         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITFILEMENUITEMS0,
<a name="l00236"></a>00236               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Open\tCTRL+O'</span>)
<a name="l00237"></a>00237         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITFILEMENUITEMS1,
<a name="l00238"></a>00238               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Save\tCTRL+S'</span>)
<a name="l00239"></a>00239         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITFILEMENUITEMS2,
<a name="l00240"></a>00240               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Close\tCTRL+W'</span>)
<a name="l00241"></a>00241         parent.AppendSeparator()
<a name="l00242"></a>00242         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITFILEMENUITEMS4,
<a name="l00243"></a>00243               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Exit'</span>)
<a name="l00244"></a>00244         self.Bind(wx.EVT_MENU, self.OnOpenProjectMenu,
<a name="l00245"></a>00245               id=wxID_NETWORKEDITFILEMENUITEMS0)
<a name="l00246"></a>00246         self.Bind(wx.EVT_MENU, self.OnSaveProjectMenu,
<a name="l00247"></a>00247               id=wxID_NETWORKEDITFILEMENUITEMS1)
<a name="l00248"></a>00248 <span class="comment">##        self.Bind(wx.EVT_MENU, self.OnCloseProjectMenu,</span>
<a name="l00249"></a>00249 <span class="comment">##              id=wxID_NETWORKEDITFILEMENUITEMS2)</span>
<a name="l00250"></a>00250         self.Bind(wx.EVT_MENU, self.OnQuitMenu,
<a name="l00251"></a>00251               id=wxID_NETWORKEDITFILEMENUITEMS4)
<a name="l00252"></a>00252         self.Bind(wx.EVT_MENU, self.OnNewProjectMenu,
<a name="l00253"></a>00253               id=wxID_NETWORKEDITFILEMENUITEMS5)
<a name="l00254"></a>00254     
<a name="l00255"></a><a class="code" href="namespacenetworkedit.html#0f0b314087ded2fd5edee0b43ebff236">00255</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#0f0b314087ded2fd5edee0b43ebff236">_init_coll_NetworkMenu_Items</a>(self, parent):
<a name="l00256"></a>00256         <span class="comment"># generated method, don't edit</span>
<a name="l00257"></a>00257 
<a name="l00258"></a>00258         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITNETWORKMENUITEMS0,
<a name="l00259"></a>00259               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Add Slave Node'</span>)
<a name="l00260"></a>00260         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITNETWORKMENUITEMS1,
<a name="l00261"></a>00261               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Remove Slave Node'</span>)
<a name="l00262"></a>00262         parent.AppendSeparator()
<a name="l00263"></a>00263         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITNETWORKMENUITEMS3,
<a name="l00264"></a>00264               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Build Master Dictionary'</span>)
<a name="l00265"></a>00265         self.Bind(wx.EVT_MENU, self.OnAddSlaveMenu,
<a name="l00266"></a>00266               id=wxID_NETWORKEDITNETWORKMENUITEMS0)
<a name="l00267"></a>00267         self.Bind(wx.EVT_MENU, self.OnRemoveSlaveMenu,
<a name="l00268"></a>00268               id=wxID_NETWORKEDITNETWORKMENUITEMS1)
<a name="l00269"></a>00269 <span class="comment">##        self.Bind(wx.EVT_MENU, self.OnBuildMasterMenu,</span>
<a name="l00270"></a>00270 <span class="comment">##              id=wxID_NETWORKEDITNETWORKMENUITEMS3)</span>
<a name="l00271"></a>00271     
<a name="l00272"></a><a class="code" href="namespacenetworkedit.html#941927e6e7615ba804042de3ece1e97f">00272</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#941927e6e7615ba804042de3ece1e97f">_init_coll_AddMenu_Items</a>(self, parent):
<a name="l00273"></a>00273         <span class="comment"># generated method, don't edit</span>
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITADDMENUITEMS0,
<a name="l00276"></a>00276               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'SDO Server'</span>)
<a name="l00277"></a>00277         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITADDMENUITEMS1,
<a name="l00278"></a>00278               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'SDO Client'</span>)
<a name="l00279"></a>00279         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITADDMENUITEMS2,
<a name="l00280"></a>00280               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'PDO Transmit'</span>)
<a name="l00281"></a>00281         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITADDMENUITEMS3,
<a name="l00282"></a>00282               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'PDO Receive'</span>)
<a name="l00283"></a>00283         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITADDMENUITEMS4,
<a name="l00284"></a>00284               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Map Variable'</span>)
<a name="l00285"></a>00285         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_NETWORKEDITADDMENUITEMS5,
<a name="l00286"></a>00286               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'User Type'</span>)
<a name="l00287"></a>00287         self.Bind(wx.EVT_MENU, self.OnAddSDOServerMenu,
<a name="l00288"></a>00288               id=wxID_NETWORKEDITADDMENUITEMS0)
<a name="l00289"></a>00289         self.Bind(wx.EVT_MENU, self.OnAddSDOClientMenu,
<a name="l00290"></a>00290               id=wxID_NETWORKEDITADDMENUITEMS1)
<a name="l00291"></a>00291         self.Bind(wx.EVT_MENU, self.OnAddPDOTransmitMenu,
<a name="l00292"></a>00292               id=wxID_NETWORKEDITADDMENUITEMS2)
<a name="l00293"></a>00293         self.Bind(wx.EVT_MENU, self.OnAddPDOReceiveMenu,
<a name="l00294"></a>00294               id=wxID_NETWORKEDITADDMENUITEMS3)
<a name="l00295"></a>00295         self.Bind(wx.EVT_MENU, self.OnAddMapVariableMenu,
<a name="l00296"></a>00296               id=wxID_NETWORKEDITADDMENUITEMS4)
<a name="l00297"></a>00297         self.Bind(wx.EVT_MENU, self.OnAddUserTypeMenu,
<a name="l00298"></a>00298               id=wxID_NETWORKEDITADDMENUITEMS5)
<a name="l00299"></a>00299 
<a name="l00300"></a><a class="code" href="namespacenetworkedit.html#e2c968ea57457a5a0c05104c526e900d">00300</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#e2c968ea57457a5a0c05104c526e900d">_init_coll_HelpBar_Fields</a>(self, parent):
<a name="l00301"></a>00301         <span class="comment"># generated method, don't edit</span>
<a name="l00302"></a>00302         parent.SetFieldsCount(3)
<a name="l00303"></a>00303 
<a name="l00304"></a>00304         parent.SetStatusText(number=0, text=<span class="stringliteral">''</span>)
<a name="l00305"></a>00305         parent.SetStatusText(number=1, text=<span class="stringliteral">''</span>)
<a name="l00306"></a>00306         parent.SetStatusText(number=2, text=<span class="stringliteral">''</span>)
<a name="l00307"></a>00307 
<a name="l00308"></a>00308         parent.SetStatusWidths([100, 110, -1])
<a name="l00309"></a>00309 
<a name="l00310"></a><a class="code" href="namespacenetworkedit.html#a1cd2a66c69c00d34dffdb3e53101fcd">00310</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#a1cd2a66c69c00d34dffdb3e53101fcd">_init_utils</a>(self):
<a name="l00311"></a>00311         <span class="comment"># generated method, don't edit</span>
<a name="l00312"></a>00312         self.menuBar1 = wx.MenuBar()
<a name="l00313"></a>00313         self.menuBar1.SetEvtHandlerEnabled(<span class="keyword">True</span>)
<a name="l00314"></a>00314         
<a name="l00315"></a>00315         <span class="keywordflow">if</span> self.Mode == <span class="stringliteral">"solo"</span>:
<a name="l00316"></a>00316             self.FileMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00317"></a>00317         
<a name="l00318"></a>00318         self.NetworkMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         self.EditMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00321"></a>00321 
<a name="l00322"></a>00322         self.AddMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00323"></a>00323 
<a name="l00324"></a>00324         self.HelpMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         self._init_coll_menuBar1_Menus(self.menuBar1)
<a name="l00327"></a>00327         <span class="keywordflow">if</span> self.Mode == <span class="stringliteral">"solo"</span>:
<a name="l00328"></a>00328             self._init_coll_FileMenu_Items(self.FileMenu)
<a name="l00329"></a>00329         self._init_coll_NetworkMenu_Items(self.NetworkMenu)
<a name="l00330"></a>00330         self._init_coll_EditMenu_Items(self.EditMenu)
<a name="l00331"></a>00331         self._init_coll_AddMenu_Items(self.AddMenu)
<a name="l00332"></a>00332         self._init_coll_HelpMenu_Items(self.HelpMenu)
<a name="l00333"></a>00333 
<a name="l00334"></a><a class="code" href="namespacenetworkedit.html#fe1c1ffc78b7a7416942b40633884018">00334</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#fe1c1ffc78b7a7416942b40633884018">_init_ctrls</a>(self, prnt):
<a name="l00335"></a>00335         <span class="comment"># generated method, don't edit</span>
<a name="l00336"></a>00336         wx.Frame.__init__(self, id=wxID_NETWORKEDIT, name=<span class="stringliteral">'networkedit'</span>,
<a name="l00337"></a>00337               parent=prnt, pos=wx.Point(149, 178), size=wx.Size(1000, 700),
<a name="l00338"></a>00338               style=wx.DEFAULT_FRAME_STYLE, title=<span class="stringliteral">'Networkedit'</span>)
<a name="l00339"></a>00339         self._init_utils()
<a name="l00340"></a>00340         self.SetClientSize(wx.Size(1000, 700))
<a name="l00341"></a>00341         self.SetMenuBar(self.menuBar1)
<a name="l00342"></a>00342 <span class="comment">##        self.Bind(wx.EVT_CLOSE, self.OnCloseFrame, id=wxID_NETWORKEDIT)</span>
<a name="l00343"></a>00343 
<a name="l00344"></a>00344         self.NetworkNodes = wx.Notebook(id=wxID_NETWORKEDITNETWORKNODES,
<a name="l00345"></a>00345               name=<span class="stringliteral">'NetworkNodes'</span>, parent=self, pos=wx.Point(0, 0),
<a name="l00346"></a>00346               size=wx.Size(0, 0), style=wxNB_LEFT)
<a name="l00347"></a>00347         self.NetworkNodes.Bind(wx.EVT_NOTEBOOK_PAGE_CHANGED,
<a name="l00348"></a>00348               self.OnNodeSelectedChanged, id=wxID_NETWORKEDITNETWORKNODES)
<a name="l00349"></a>00349 
<a name="l00350"></a>00350         self.HelpBar = wx.StatusBar(id=wxID_NETWORKEDITHELPBAR, name=<span class="stringliteral">'HelpBar'</span>,
<a name="l00351"></a>00351               parent=self, style=wxST_SIZEGRIP)
<a name="l00352"></a>00352         self._init_coll_HelpBar_Fields(self.HelpBar)
<a name="l00353"></a>00353         self.SetStatusBar(self.HelpBar)
<a name="l00354"></a>00354 
<a name="l00355"></a><a class="code" href="namespacenetworkedit.html#82e0d4ac55ecdf8bf2a154ef2747c7b5">00355</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#82e0d4ac55ecdf8bf2a154ef2747c7b5">__init__</a>(self, parent, mode = "solo", nodelist = None):
<a name="l00356"></a><a class="code" href="namespacenetworkedit.html#6d69d76b8b1b34286bca7d797b7d9053">00356</a>         self.Mode = mode
<a name="l00357"></a>00357         self._init_ctrls(parent)
<a name="l00358"></a><a class="code" href="namespacenetworkedit.html#ddee62320ad1538935c4fb221114ad6c">00358</a>         self.HtmlFrameOpened = []
<a name="l00359"></a>00359         
<a name="l00360"></a><a class="code" href="namespacenetworkedit.html#6d69d76b8b1b34286bca7d797b7d9053">00360</a>         <span class="keywordflow">if</span> self.Mode == <span class="stringliteral">"solo"</span>:
<a name="l00361"></a><a class="code" href="namespacenetworkedit.html#cf4848f1a2b858ef442d2bcb3a348af1">00361</a>             self.Manager = NodeManager(ScriptDirectory)
<a name="l00362"></a>00362             <span class="keywordflow">if</span> projectOpen:
<a name="l00363"></a><a class="code" href="namespacenetworkedit.html#6a4290ba38225a18362b4ef9a9463b80">00363</a>                 self.NodeList = NodeList(self.Manager)
<a name="l00364"></a>00364                 result = self.NodeList.LoadProject(projectOpen)
<a name="l00365"></a>00365                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00366"></a>00366                     self.RefreshNetworkNodes()
<a name="l00367"></a>00367             <span class="keywordflow">else</span>:
<a name="l00368"></a><a class="code" href="namespacenetworkedit.html#6a4290ba38225a18362b4ef9a9463b80">00368</a>                 self.NodeList = <span class="keywordtype">None</span>
<a name="l00369"></a>00369         <span class="keywordflow">else</span>:
<a name="l00370"></a><a class="code" href="namespacenetworkedit.html#6a4290ba38225a18362b4ef9a9463b80">00370</a>             self.NodeList = nodelist
<a name="l00371"></a><a class="code" href="namespacenetworkedit.html#cf4848f1a2b858ef442d2bcb3a348af1">00371</a>             self.Manager = self.NodeList.GetManager()
<a name="l00372"></a>00372         
<a name="l00373"></a>00373         self.RefreshBufferState()
<a name="l00374"></a>00374         self.RefreshTitle()
<a name="l00375"></a>00375         self.RefreshMainMenu()
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="namespacenetworkedit.html#49f12cd3b720322e147f77841999dbd3">00377</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#49f12cd3b720322e147f77841999dbd3">GetNoteBook</a>(self):
<a name="l00378"></a>00378         <span class="keywordflow">return</span> self.NetworkNodes
<a name="l00379"></a>00379 
<a name="l00380"></a><a class="code" href="namespacenetworkedit.html#854bbe7eafaaa933738f2c74569b7ea3">00380</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#854bbe7eafaaa933738f2c74569b7ea3">OnQuitMenu</a>(self, event):
<a name="l00381"></a>00381         self.Close()
<a name="l00382"></a>00382         event.Skip()
<a name="l00383"></a>00383 
<a name="l00384"></a><a class="code" href="namespacenetworkedit.html#b8badc56d1e65b90cadda0933b7231a1">00384</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#b8badc56d1e65b90cadda0933b7231a1">OnAddSDOServerMenu</a>(self, event):
<a name="l00385"></a>00385         self.Manager.AddSDOServerToCurrent()
<a name="l00386"></a>00386         self.RefreshBufferState()
<a name="l00387"></a>00387         self.RefreshCurrentIndexList()
<a name="l00388"></a>00388         event.Skip()
<a name="l00389"></a>00389     
<a name="l00390"></a><a class="code" href="namespacenetworkedit.html#3ddbeac7f2aa5d9eb954e410c5f9eb0a">00390</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#3ddbeac7f2aa5d9eb954e410c5f9eb0a">OnAddSDOClientMenu</a>(self, event):
<a name="l00391"></a>00391         self.Manager.AddSDOClientToCurrent()
<a name="l00392"></a>00392         self.RefreshBufferState()
<a name="l00393"></a>00393         self.RefreshCurrentIndexList()
<a name="l00394"></a>00394         event.Skip()
<a name="l00395"></a>00395 
<a name="l00396"></a><a class="code" href="namespacenetworkedit.html#ce0a870981c8a339344cefc5d6585033">00396</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#ce0a870981c8a339344cefc5d6585033">OnAddPDOTransmitMenu</a>(self, event):
<a name="l00397"></a>00397         self.Manager.AddPDOTransmitToCurrent()
<a name="l00398"></a>00398         self.RefreshBufferState()
<a name="l00399"></a>00399         self.RefreshCurrentIndexList()
<a name="l00400"></a>00400         event.Skip()
<a name="l00401"></a>00401 
<a name="l00402"></a><a class="code" href="namespacenetworkedit.html#d9b96580122ed08bafeedbdea8aea934">00402</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#d9b96580122ed08bafeedbdea8aea934">OnAddPDOReceiveMenu</a>(self, event):
<a name="l00403"></a>00403         self.Manager.AddPDOReceiveToCurrent()
<a name="l00404"></a>00404         self.RefreshBufferState()
<a name="l00405"></a>00405         self.RefreshCurrentIndexList()
<a name="l00406"></a>00406         event.Skip()
<a name="l00407"></a>00407 
<a name="l00408"></a><a class="code" href="namespacenetworkedit.html#0b66d8079bf72006032d854ab966d03c">00408</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#0b66d8079bf72006032d854ab966d03c">OnAddMapVariableMenu</a>(self, event):
<a name="l00409"></a>00409         self.AddMapVariable()
<a name="l00410"></a>00410         event.Skip()
<a name="l00411"></a>00411 
<a name="l00412"></a><a class="code" href="namespacenetworkedit.html#d6aa6d1dd5c2e4c1d7b9080e4c6744b0">00412</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#d6aa6d1dd5c2e4c1d7b9080e4c6744b0">OnAddUserTypeMenu</a>(self, event):
<a name="l00413"></a>00413         self.AddUserType()
<a name="l00414"></a>00414         event.Skip()
<a name="l00415"></a>00415 
<a name="l00416"></a><a class="code" href="namespacenetworkedit.html#5998cd277c097979131afcdda5f39464">00416</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#5998cd277c097979131afcdda5f39464">OnNodeSelectedChanged</a>(self, event):
<a name="l00417"></a>00417         selected = event.GetSelection()
<a name="l00418"></a>00418         <span class="comment"># At init selected = -1</span>
<a name="l00419"></a>00419         <span class="keywordflow">if</span> selected &gt; 0:
<a name="l00420"></a>00420             window = self.NetworkNodes.GetPage(selected)
<a name="l00421"></a>00421             self.NodeList.SetCurrentSelected(window.GetIndex())
<a name="l00422"></a>00422         self.RefreshMainMenu()
<a name="l00423"></a>00423         self.RefreshStatusBar()
<a name="l00424"></a>00424         event.Skip()
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00427"></a>00427 <span class="comment">#                         Load and Save Funtions</span>
<a name="l00428"></a>00428 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="namespacenetworkedit.html#900ce0c234a0cb0b051e23780999e052">00430</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#900ce0c234a0cb0b051e23780999e052">OnNewProjectMenu</a>(self, event):
<a name="l00431"></a>00431         <span class="keywordflow">if</span> self.NodeList:
<a name="l00432"></a>00432             defaultpath = os.path.dirname(self.NodeList.GetRoot())
<a name="l00433"></a>00433         <span class="keywordflow">else</span>:
<a name="l00434"></a>00434             defaultpath = os.getcwd()
<a name="l00435"></a>00435         dialog = wxDirDialog(self , <span class="stringliteral">"Choose a project"</span>, defaultpath, wxDD_NEW_DIR_BUTTON)
<a name="l00436"></a>00436         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00437"></a>00437             projectpath = dialog.GetPath()
<a name="l00438"></a>00438             <span class="keywordflow">if</span> os.path.isdir(projectpath) <span class="keywordflow">and</span> len(os.listdir(projectpath)) == 0:
<a name="l00439"></a>00439                 manager = NodeManager(ScriptDirectory)
<a name="l00440"></a>00440                 nodelist = NodeList(manager)
<a name="l00441"></a>00441                 result = nodelist.LoadProject(projectpath)
<a name="l00442"></a>00442                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00443"></a><a class="code" href="namespacenetworkedit.html#cf4848f1a2b858ef442d2bcb3a348af1">00443</a>                     self.Manager = manager
<a name="l00444"></a><a class="code" href="namespacenetworkedit.html#6a4290ba38225a18362b4ef9a9463b80">00444</a>                     self.NodeList = nodelist
<a name="l00445"></a>00445                     self.NodeList.SetCurrentSelected(0)
<a name="l00446"></a>00446                                         
<a name="l00447"></a>00447                     self.RefreshNetworkNodes()
<a name="l00448"></a>00448                     self.RefreshBufferState()
<a name="l00449"></a>00449                     self.RefreshTitle()
<a name="l00450"></a>00450                     self.RefreshProfileMenu()
<a name="l00451"></a>00451                     self.RefreshMainMenu()
<a name="l00452"></a>00452                 <span class="keywordflow">else</span>:
<a name="l00453"></a>00453                     message = wxMessageDialog(self, result, <span class="stringliteral">"ERROR"</span>, wxOK|wxICON_ERROR)
<a name="l00454"></a>00454                     message.ShowModal()
<a name="l00455"></a>00455                     message.Destroy()
<a name="l00456"></a>00456         event.Skip()
<a name="l00457"></a>00457 
<a name="l00458"></a><a class="code" href="namespacenetworkedit.html#7ffb18f26bd0a019c59e9402373b904e">00458</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#7ffb18f26bd0a019c59e9402373b904e">OnOpenProjectMenu</a>(self, event):
<a name="l00459"></a>00459         <span class="keywordflow">if</span> self.NodeList:
<a name="l00460"></a>00460             defaultpath = os.path.dirname(self.NodeList.GetRoot())
<a name="l00461"></a>00461         <span class="keywordflow">else</span>:
<a name="l00462"></a>00462             defaultpath = os.getcwd()
<a name="l00463"></a>00463         dialog = wxDirDialog(self , <span class="stringliteral">"Choose a project"</span>, defaultpath, 0)
<a name="l00464"></a>00464         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00465"></a>00465             projectpath = dialog.GetPath()
<a name="l00466"></a>00466             <span class="keywordflow">if</span> os.path.isdir(projectpath):
<a name="l00467"></a>00467                 manager = NodeManager(ScriptDirectory)
<a name="l00468"></a>00468                 nodelist = NodeList(manager)
<a name="l00469"></a>00469                 result = nodelist.LoadProject(projectpath)
<a name="l00470"></a>00470                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00471"></a><a class="code" href="namespacenetworkedit.html#cf4848f1a2b858ef442d2bcb3a348af1">00471</a>                     self.Manager = manager
<a name="l00472"></a><a class="code" href="namespacenetworkedit.html#6a4290ba38225a18362b4ef9a9463b80">00472</a>                     self.NodeList = nodelist
<a name="l00473"></a>00473                     self.NodeList.SetCurrentSelected(0)
<a name="l00474"></a>00474                     
<a name="l00475"></a>00475                     self.RefreshNetworkNodes()
<a name="l00476"></a>00476                     self.RefreshBufferState()
<a name="l00477"></a>00477                     self.RefreshTitle()
<a name="l00478"></a>00478                     self.RefreshProfileMenu()
<a name="l00479"></a>00479                     self.RefreshMainMenu()
<a name="l00480"></a>00480                 <span class="keywordflow">else</span>:
<a name="l00481"></a>00481                     message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00482"></a>00482                     message.ShowModal()
<a name="l00483"></a>00483                     message.Destroy()
<a name="l00484"></a>00484         dialog.Destroy()
<a name="l00485"></a>00485         event.Skip()
<a name="l00486"></a>00486 
<a name="l00487"></a><a class="code" href="namespacenetworkedit.html#38a5bbe86087f2d696bcd53f922d6450">00487</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#38a5bbe86087f2d696bcd53f922d6450">OnSaveProjectMenu</a>(self, event):
<a name="l00488"></a>00488         result = self.NodeList.SaveProject()
<a name="l00489"></a>00489         <span class="keywordflow">if</span> result:
<a name="l00490"></a>00490             message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00491"></a>00491             message.ShowModal()
<a name="l00492"></a>00492             message.Destroy()
<a name="l00493"></a>00493         event.Skip()
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00496"></a>00496 <span class="comment">#                             Slave Nodes Management</span>
<a name="l00497"></a>00497 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00498"></a>00498 
<a name="l00499"></a><a class="code" href="namespacenetworkedit.html#4ff91dd5ec49b8435fc4871ad91cc150">00499</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#4ff91dd5ec49b8435fc4871ad91cc150">OnAddSlaveMenu</a>(self, event):
<a name="l00500"></a>00500         dialog = AddSlaveDialog(self)
<a name="l00501"></a>00501         dialog.SetNodeList(self.NodeList)
<a name="l00502"></a>00502         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00503"></a>00503             values = dialog.GetValues()
<a name="l00504"></a>00504             result = self.NodeList.AddSlaveNode(values[<span class="stringliteral">"slaveName"</span>], values[<span class="stringliteral">"slaveNodeID"</span>], values[<span class="stringliteral">"edsFile"</span>])
<a name="l00505"></a>00505             <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00506"></a>00506                 new_editingpanel = EditingPanel(self, self.NodeList, <span class="keyword">False</span>)
<a name="l00507"></a>00507                 new_editingpanel.SetIndex(values[<span class="stringliteral">"slaveNodeID"</span>])
<a name="l00508"></a>00508                 idx = self.NodeList.GetOrderNumber(values[<span class="stringliteral">"slaveNodeID"</span>])
<a name="l00509"></a>00509                 self.NetworkNodes.InsertPage(idx, new_editingpanel, <span class="stringliteral">""</span>)
<a name="l00510"></a>00510                 self.NodeList.SetCurrentSelected(idx)
<a name="l00511"></a>00511                 self.NetworkNodes.SetSelection(idx)
<a name="l00512"></a>00512                 self.RefreshBufferState()
<a name="l00513"></a>00513             <span class="keywordflow">else</span>:
<a name="l00514"></a>00514                 message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00515"></a>00515                 message.ShowModal()
<a name="l00516"></a>00516                 message.Destroy()
<a name="l00517"></a>00517         dialog.Destroy()
<a name="l00518"></a>00518         event.Skip()
<a name="l00519"></a>00519 
<a name="l00520"></a><a class="code" href="namespacenetworkedit.html#3c3acc2994f8e2230cef333585c6354f">00520</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#3c3acc2994f8e2230cef333585c6354f">OnRemoveSlaveMenu</a>(self, event):
<a name="l00521"></a>00521         slavenames = self.NodeList.GetSlaveNames()
<a name="l00522"></a>00522         slaveids = self.NodeList.GetSlaveIDs()
<a name="l00523"></a>00523         dialog = wxSingleChoiceDialog(self, <span class="stringliteral">"Choose a slave to remove"</span>, <span class="stringliteral">"Remove slave"</span>, slavenames)
<a name="l00524"></a>00524         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00525"></a>00525             choice = dialog.GetSelection()
<a name="l00526"></a>00526             result = self.NodeList.RemoveSlaveNode(slaveids[choice])
<a name="l00527"></a>00527             <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00528"></a>00528                 slaveids.pop(choice)
<a name="l00529"></a>00529                 current = self.NetworkNodes.GetSelection()
<a name="l00530"></a>00530                 self.NetworkNodes.DeletePage(choice + 1)
<a name="l00531"></a>00531                 <span class="keywordflow">if</span> self.NetworkNodes.GetPageCount() &gt; 0:
<a name="l00532"></a>00532                     new_selection = min(current, self.NetworkNodes.GetPageCount() - 1)
<a name="l00533"></a>00533                     self.NetworkNodes.SetSelection(new_selection)
<a name="l00534"></a>00534                     <span class="keywordflow">if</span> new_selection &gt; 0:
<a name="l00535"></a>00535                         self.NodeList.SetCurrentSelected(slaveids[new_selection - 1])
<a name="l00536"></a>00536                     self.RefreshBufferState()
<a name="l00537"></a>00537             <span class="keywordflow">else</span>:
<a name="l00538"></a>00538                 message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00539"></a>00539                 message.ShowModal()
<a name="l00540"></a>00540                 message.Destroy()
<a name="l00541"></a>00541         event.Skip()
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00544"></a>00544 <span class="comment">#                             Refresh Functions</span>
<a name="l00545"></a>00545 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00546"></a>00546 
<a name="l00547"></a><a class="code" href="namespacenetworkedit.html#84786509128cc13e6e1135aadac688ac">00547</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#84786509128cc13e6e1135aadac688ac">RefreshTitle</a>(self):
<a name="l00548"></a>00548         <span class="keywordflow">if</span> self.NodeList != <span class="keywordtype">None</span>:
<a name="l00549"></a>00549             self.SetTitle(<span class="stringliteral">"Networkedit - %s"</span>%self.NodeList.GetNetworkName())
<a name="l00550"></a>00550         <span class="keywordflow">else</span>:
<a name="l00551"></a>00551             self.SetTitle(<span class="stringliteral">"Networkedit"</span>)
<a name="l00552"></a>00552 
<a name="l00553"></a><a class="code" href="namespacenetworkedit.html#ef988c30a20345badf3ab9b7fb3577ab">00553</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#ef988c30a20345badf3ab9b7fb3577ab">OnRefreshMenu</a>(self, event):
<a name="l00554"></a>00554         self.RefreshCurrentIndexList()
<a name="l00555"></a>00555         event.Skip()
<a name="l00556"></a>00556 
<a name="l00557"></a><a class="code" href="namespacenetworkedit.html#6d8b2e2a672b5c89f1cef538d21517c4">00557</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#6d8b2e2a672b5c89f1cef538d21517c4">RefreshCurrentIndexList</a>(self):
<a name="l00558"></a>00558         selected = self.NetworkNodes.GetSelection()
<a name="l00559"></a>00559         <span class="keywordflow">if</span> selected == 0:
<a name="l00560"></a>00560             window = self.NetworkNodes.GetPage(selected)
<a name="l00561"></a>00561             window.RefreshIndexList()
<a name="l00562"></a>00562         <span class="keywordflow">else</span>:
<a name="l00563"></a>00563             <span class="keywordflow">pass</span>
<a name="l00564"></a>00564 
<a name="l00565"></a><a class="code" href="namespacenetworkedit.html#81036ca384b8cf75d0010851755d8317">00565</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#81036ca384b8cf75d0010851755d8317">RefreshNetworkNodes</a>(self):
<a name="l00566"></a>00566         <span class="keywordflow">if</span> self.NetworkNodes.GetPageCount() &gt; 0:
<a name="l00567"></a>00567             self.NetworkNodes.DeleteAllPages()
<a name="l00568"></a>00568         <span class="keywordflow">if</span> self.NodeList:
<a name="l00569"></a>00569             new_editingpanel = EditingPanel(self, self.Manager)
<a name="l00570"></a>00570             new_editingpanel.SetIndex(0)
<a name="l00571"></a>00571             self.NetworkNodes.AddPage(new_editingpanel, <span class="stringliteral">""</span>)
<a name="l00572"></a>00572             <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> self.NodeList.GetSlaveIDs():
<a name="l00573"></a>00573                 new_editingpanel = EditingPanel(self, self.NodeList, <span class="keyword">False</span>)
<a name="l00574"></a>00574                 new_editingpanel.SetIndex(idx)
<a name="l00575"></a>00575                 self.NetworkNodes.AddPage(new_editingpanel, <span class="stringliteral">""</span>)
<a name="l00576"></a>00576 
<a name="l00577"></a><a class="code" href="namespacenetworkedit.html#1fa2b2fd11d7a6dc830586a45eee2464">00577</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#1fa2b2fd11d7a6dc830586a45eee2464">RefreshStatusBar</a>(self):
<a name="l00578"></a>00578         <span class="keywordflow">if</span> self.HelpBar:
<a name="l00579"></a>00579             window = self.NetworkNodes.GetPage(self.NetworkNodes.GetSelection())
<a name="l00580"></a>00580             selection = window.GetSelection()
<a name="l00581"></a>00581             <span class="keywordflow">if</span> selection:
<a name="l00582"></a>00582                 index, subIndex = selection
<a name="l00583"></a>00583                 <span class="keywordflow">if</span> self.NodeList.IsCurrentEntry(index):
<a name="l00584"></a>00584                     self.HelpBar.SetStatusText(<span class="stringliteral">"Index: 0x%04X"</span>%index, 0)
<a name="l00585"></a>00585                     self.HelpBar.SetStatusText(<span class="stringliteral">"Subindex: 0x%02X"</span>%subIndex, 1)
<a name="l00586"></a>00586                     entryinfos = self.NodeList.GetEntryInfos(index)
<a name="l00587"></a>00587                     name = entryinfos[<span class="stringliteral">"name"</span>]
<a name="l00588"></a>00588                     category = <span class="stringliteral">"Optional"</span>
<a name="l00589"></a>00589                     <span class="keywordflow">if</span> entryinfos[<span class="stringliteral">"need"</span>]:
<a name="l00590"></a>00590                         category = <span class="stringliteral">"Mandatory"</span>
<a name="l00591"></a>00591                     struct = <span class="stringliteral">"VAR"</span>
<a name="l00592"></a>00592                     number = <span class="stringliteral">""</span>
<a name="l00593"></a>00593                     <span class="keywordflow">if</span> entryinfos[<span class="stringliteral">"struct"</span>] &amp; OD_IdenticalIndexes:
<a name="l00594"></a>00594                         number = <span class="stringliteral">" possibly defined %d times"</span>%entryinfos[<span class="stringliteral">"nbmax"</span>]
<a name="l00595"></a>00595                     <span class="keywordflow">if</span> entryinfos[<span class="stringliteral">"struct"</span>] &amp; OD_IdenticalSubindexes:
<a name="l00596"></a>00596                         struct = <span class="stringliteral">"REC"</span>
<a name="l00597"></a>00597                     <span class="keywordflow">elif</span> entryinfos[<span class="stringliteral">"struct"</span>] &amp; OD_MultipleSubindexes:
<a name="l00598"></a>00598                         struct = <span class="stringliteral">"ARRAY"</span>
<a name="l00599"></a>00599                     text = <span class="stringliteral">"%s: %s entry of struct %s%s."</span>%(name,category,struct,number)
<a name="l00600"></a>00600                     self.HelpBar.SetStatusText(text, 2)
<a name="l00601"></a>00601                 <span class="keywordflow">else</span>:
<a name="l00602"></a>00602                     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(3):
<a name="l00603"></a>00603                         self.HelpBar.SetStatusText(<span class="stringliteral">""</span>, i)
<a name="l00604"></a>00604             <span class="keywordflow">else</span>:
<a name="l00605"></a>00605                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(3):
<a name="l00606"></a>00606                     self.HelpBar.SetStatusText(<span class="stringliteral">""</span>, i)
<a name="l00607"></a>00607 
<a name="l00608"></a><a class="code" href="namespacenetworkedit.html#f35165c7e88dca205c83933033dff40d">00608</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#f35165c7e88dca205c83933033dff40d">RefreshMainMenu</a>(self):
<a name="l00609"></a>00609         <span class="keywordflow">if</span> self.menuBar1:
<a name="l00610"></a>00610             self.NetworkMenu.Enable(wxID_NETWORKEDITNETWORKMENUITEMS3, <span class="keyword">False</span>)
<a name="l00611"></a><a class="code" href="namespacenetworkedit.html#6a4290ba38225a18362b4ef9a9463b80">00611</a>             <span class="keywordflow">if</span> self.NodeList == <span class="keywordtype">None</span>:
<a name="l00612"></a><a class="code" href="namespacenetworkedit.html#6d69d76b8b1b34286bca7d797b7d9053">00612</a>                 <span class="keywordflow">if</span> self.Mode == <span class="stringliteral">"solo"</span>:
<a name="l00613"></a>00613                     self.menuBar1.EnableTop(1, <span class="keyword">False</span>)
<a name="l00614"></a>00614                     self.menuBar1.EnableTop(2, <span class="keyword">False</span>)
<a name="l00615"></a>00615                     self.menuBar1.EnableTop(3, <span class="keyword">False</span>)
<a name="l00616"></a>00616                     <span class="keywordflow">if</span> self.FileMenu:
<a name="l00617"></a>00617                         self.FileMenu.Enable(wxID_NETWORKEDITFILEMENUITEMS1, <span class="keyword">False</span>)
<a name="l00618"></a>00618                         self.FileMenu.Enable(wxID_NETWORKEDITFILEMENUITEMS2, <span class="keyword">False</span>)
<a name="l00619"></a>00619                 <span class="keywordflow">else</span>:
<a name="l00620"></a>00620                     self.menuBar1.EnableTop(0, <span class="keyword">False</span>)
<a name="l00621"></a>00621                     self.menuBar1.EnableTop(1, <span class="keyword">False</span>)
<a name="l00622"></a>00622                     self.menuBar1.EnableTop(2, <span class="keyword">False</span>)
<a name="l00623"></a>00623             <span class="keywordflow">else</span>:
<a name="l00624"></a><a class="code" href="namespacenetworkedit.html#6d69d76b8b1b34286bca7d797b7d9053">00624</a>                 <span class="keywordflow">if</span> self.Mode == <span class="stringliteral">"solo"</span>:
<a name="l00625"></a>00625                     self.menuBar1.EnableTop(1, <span class="keyword">True</span>)
<a name="l00626"></a>00626                     <span class="keywordflow">if</span> self.FileMenu:
<a name="l00627"></a>00627                         self.FileMenu.Enable(wxID_NETWORKEDITFILEMENUITEMS1, <span class="keyword">True</span>)
<a name="l00628"></a>00628                         self.FileMenu.Enable(wxID_NETWORKEDITFILEMENUITEMS2, <span class="keyword">False</span>)
<a name="l00629"></a>00629                     <span class="keywordflow">if</span> self.NetworkNodes.GetSelection() == 0:
<a name="l00630"></a>00630                         self.menuBar1.EnableTop(2, <span class="keyword">True</span>)
<a name="l00631"></a>00631                         self.menuBar1.EnableTop(3, <span class="keyword">True</span>)
<a name="l00632"></a>00632                     <span class="keywordflow">else</span>:
<a name="l00633"></a>00633                         self.menuBar1.EnableTop(2, <span class="keyword">False</span>)      
<a name="l00634"></a>00634                         self.menuBar1.EnableTop(3, <span class="keyword">False</span>)
<a name="l00635"></a>00635                 <span class="keywordflow">else</span>:
<a name="l00636"></a>00636                     self.menuBar1.EnableTop(0, <span class="keyword">True</span>)
<a name="l00637"></a>00637                     <span class="keywordflow">if</span> self.NetworkNodes.GetSelection() == 0:
<a name="l00638"></a>00638                         self.menuBar1.EnableTop(1, <span class="keyword">True</span>)
<a name="l00639"></a>00639                         self.menuBar1.EnableTop(2, <span class="keyword">True</span>)
<a name="l00640"></a>00640                     <span class="keywordflow">else</span>:
<a name="l00641"></a>00641                         self.menuBar1.EnableTop(1, <span class="keyword">False</span>)      
<a name="l00642"></a>00642                         self.menuBar1.EnableTop(2, <span class="keyword">False</span>)
<a name="l00643"></a>00643 
<a name="l00644"></a><a class="code" href="namespacenetworkedit.html#16a1bfa553c27346c1afa95283839ff0">00644</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#16a1bfa553c27346c1afa95283839ff0">RefreshProfileMenu</a>(self):
<a name="l00645"></a>00645         <span class="keywordflow">if</span> self.EditMenu:
<a name="l00646"></a>00646             profile = self.Manager.GetCurrentProfileName()
<a name="l00647"></a>00647             edititem = self.EditMenu.FindItemById(wxID_NETWORKEDITEDITMENUITEMS7)
<a name="l00648"></a>00648             <span class="keywordflow">if</span> edititem:
<a name="l00649"></a>00649                 length = self.AddMenu.GetMenuItemCount()
<a name="l00650"></a>00650                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(length-6):
<a name="l00651"></a>00651                     additem = self.AddMenu.FindItemByPosition(6)
<a name="l00652"></a>00652                     self.AddMenu.Delete(additem.GetId())
<a name="l00653"></a>00653                 <span class="keywordflow">if</span> profile <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">"None"</span>, <span class="stringliteral">"DS-301"</span>):
<a name="l00654"></a>00654                     edititem.SetText(<span class="stringliteral">"%s Profile"</span>%profile)
<a name="l00655"></a>00655                     edititem.Enable(<span class="keyword">True</span>)
<a name="l00656"></a>00656                     self.AddMenu.AppendSeparator()
<a name="l00657"></a>00657                     <span class="keywordflow">for</span> text, indexes <span class="keywordflow">in</span> self.Manager.GetCurrentSpecificMenu():
<a name="l00658"></a>00658                         new_id = wx.NewId()
<a name="l00659"></a>00659                         self.AddMenu.Append(help=<span class="stringliteral">''</span>, id=new_id, kind=wx.ITEM_NORMAL, text=text)
<a name="l00660"></a>00660                         self.Bind(wx.EVT_MENU, self.GetProfileCallBack(text), id=new_id)
<a name="l00661"></a>00661                 <span class="keywordflow">else</span>:
<a name="l00662"></a>00662                     edititem.SetText(<span class="stringliteral">"Other Profile"</span>)
<a name="l00663"></a>00663                     edititem.Enable(<span class="keyword">False</span>)
<a name="l00664"></a>00664 
<a name="l00665"></a>00665 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00666"></a>00666 <span class="comment">#                              Buffer Functions</span>
<a name="l00667"></a>00667 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00668"></a>00668 
<a name="l00669"></a><a class="code" href="namespacenetworkedit.html#74f3ac94488160a26836197de52b9fd2">00669</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#74f3ac94488160a26836197de52b9fd2">RefreshBufferState</a>(self):
<a name="l00670"></a>00670         <span class="keywordflow">if</span> self.NodeList:
<a name="l00671"></a>00671             nodeID = self.Manager.GetCurrentNodeID()
<a name="l00672"></a>00672             <span class="keywordflow">if</span> nodeID != <span class="keywordtype">None</span>:
<a name="l00673"></a>00673                 nodename = <span class="stringliteral">"0x%2.2X %s"</span>%(nodeID, self.Manager.GetCurrentNodeName())
<a name="l00674"></a>00674             <span class="keywordflow">else</span>:
<a name="l00675"></a>00675                 nodename = self.Manager.GetCurrentNodeName()
<a name="l00676"></a>00676             self.NetworkNodes.SetPageText(0, nodename)
<a name="l00677"></a>00677             <span class="keywordflow">for</span> idx, name <span class="keywordflow">in</span> enumerate(self.NodeList.GetSlaveNames()):
<a name="l00678"></a>00678                 self.NetworkNodes.SetPageText(idx + 1, name)
<a name="l00679"></a>00679             self.RefreshTitle()
<a name="l00680"></a>00680 
<a name="l00681"></a><a class="code" href="namespacenetworkedit.html#f5979f3a6d283393fb5a68ab22934abb">00681</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#f5979f3a6d283393fb5a68ab22934abb">OnUndoMenu</a>(self, event):
<a name="l00682"></a>00682         self.Manager.LoadCurrentPrevious()
<a name="l00683"></a>00683         self.RefreshCurrentIndexList()
<a name="l00684"></a>00684         self.RefreshBufferState()
<a name="l00685"></a>00685         event.Skip()
<a name="l00686"></a>00686 
<a name="l00687"></a><a class="code" href="namespacenetworkedit.html#dd170a72c3140d1508f621922d3c54df">00687</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#dd170a72c3140d1508f621922d3c54df">OnRedoMenu</a>(self, event):
<a name="l00688"></a>00688         self.Manager.LoadCurrentNext()
<a name="l00689"></a>00689         self.RefreshCurrentIndexList()
<a name="l00690"></a>00690         self.RefreshBufferState()
<a name="l00691"></a>00691         event.Skip()
<a name="l00692"></a>00692 
<a name="l00693"></a>00693 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00694"></a>00694 <span class="comment">#                                Help Method</span>
<a name="l00695"></a>00695 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00696"></a>00696 
<a name="l00697"></a><a class="code" href="namespacenetworkedit.html#a41a7f8c80dcf62ea786deda026be61e">00697</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#a41a7f8c80dcf62ea786deda026be61e">OnHelpDS301Menu</a>(self, event):
<a name="l00698"></a>00698         find_index = <span class="keyword">False</span>
<a name="l00699"></a>00699         selected = self.NetworkNodes.GetSelection()
<a name="l00700"></a>00700         <span class="keywordflow">if</span> selected &gt;= 0:
<a name="l00701"></a>00701             window = self.NetworkNodes.GetPage(selected)
<a name="l00702"></a>00702             result = window.GetSelection()
<a name="l00703"></a>00703             <span class="keywordflow">if</span> result:
<a name="l00704"></a>00704                 find_index = <span class="keyword">True</span>
<a name="l00705"></a>00705                 index, subIndex = result
<a name="l00706"></a>00706                 result = OpenPDFDocIndex(index, ScriptDirectory)
<a name="l00707"></a>00707                 <span class="keywordflow">if</span> type(result) == StringType:
<a name="l00708"></a>00708                     message = wxMessageDialog(self, result, <span class="stringliteral">"ERROR"</span>, wxOK|wxICON_ERROR)
<a name="l00709"></a>00709                     message.ShowModal()
<a name="l00710"></a>00710                     message.Destroy()
<a name="l00711"></a>00711         <span class="keywordflow">if</span> <span class="keywordflow">not</span> find_index:
<a name="l00712"></a>00712             result = OpenPDFDocIndex(<span class="keywordtype">None</span>, ScriptDirectory)
<a name="l00713"></a>00713             <span class="keywordflow">if</span> type(result) == StringType:
<a name="l00714"></a>00714                 message = wxMessageDialog(self, result, <span class="stringliteral">"ERROR"</span>, wxOK|wxICON_ERROR)
<a name="l00715"></a>00715                 message.ShowModal()
<a name="l00716"></a>00716                 message.Destroy()
<a name="l00717"></a>00717         event.Skip()
<a name="l00718"></a>00718         
<a name="l00719"></a><a class="code" href="namespacenetworkedit.html#93a70d630ce5859be11aef8d8d946422">00719</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#93a70d630ce5859be11aef8d8d946422">OnHelpCANFestivalMenu</a>(self, event):
<a name="l00720"></a>00720         <span class="comment">#self.OpenHtmlFrame("CAN Festival Reference", os.path.join(ScriptDirectory, "doc/canfestival.html"), wx.Size(1000, 600))</span>
<a name="l00721"></a>00721         os.system(<span class="stringliteral">"xpdf -remote CANFESTIVAL %s %d &amp;"</span>%(os.path.join(ScriptDirectory, <span class="stringliteral">"doc/manual_en.pdf"</span>),16))
<a name="l00722"></a>00722         event.Skip()
<a name="l00723"></a>00723 
<a name="l00724"></a><a class="code" href="namespacenetworkedit.html#c5778c6a10ff341bd15264380d24fa42">00724</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#c5778c6a10ff341bd15264380d24fa42">OnAboutMenu</a>(self, event):
<a name="l00725"></a>00725         self.OpenHtmlFrame(<span class="stringliteral">"About CAN Festival"</span>, os.path.join(ScriptDirectory, <span class="stringliteral">"doc/about.html"</span>), wx.Size(500, 450))
<a name="l00726"></a>00726         event.Skip()
<a name="l00727"></a>00727 
<a name="l00728"></a><a class="code" href="namespacenetworkedit.html#0acd7681be496b4948ad18897ea13ac4">00728</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#0acd7681be496b4948ad18897ea13ac4">OpenHtmlFrame</a>(self, title, file, size):
<a name="l00729"></a>00729         <span class="keywordflow">if</span> title <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.HtmlFrameOpened:
<a name="l00730"></a>00730             self.HtmlFrameOpened.append(title)
<a name="l00731"></a>00731             window = HtmlFrame(self, self.HtmlFrameOpened)
<a name="l00732"></a>00732             window.SetTitle(title)
<a name="l00733"></a>00733             window.SetHtmlPage(file)
<a name="l00734"></a>00734             window.SetClientSize(size)
<a name="l00735"></a>00735             window.Show()
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00738"></a>00738 <span class="comment">#                          Editing Profiles functions</span>
<a name="l00739"></a>00739 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00740"></a>00740 
<a name="l00741"></a><a class="code" href="namespacenetworkedit.html#85896082081260d8321487b78afeb70e">00741</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#85896082081260d8321487b78afeb70e">OnCommunicationMenu</a>(self, event):
<a name="l00742"></a>00742         dictionary,current = self.Manager.GetCurrentCommunicationLists()
<a name="l00743"></a>00743         self.EditProfile(<span class="stringliteral">"Edit DS-301 Profile"</span>, dictionary, current)
<a name="l00744"></a>00744         event.Skip()
<a name="l00745"></a>00745     
<a name="l00746"></a><a class="code" href="namespacenetworkedit.html#9e4005cf6d6c158c997d5efb8b9c2694">00746</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#9e4005cf6d6c158c997d5efb8b9c2694">OnOtherCommunicationMenu</a>(self, event):
<a name="l00747"></a>00747         dictionary,current = self.Manager.GetCurrentDS302Lists()
<a name="l00748"></a>00748         self.EditProfile(<span class="stringliteral">"Edit DS-301 Profile"</span>, dictionary, current)
<a name="l00749"></a>00749         event.Skip()
<a name="l00750"></a>00750     
<a name="l00751"></a><a class="code" href="namespacenetworkedit.html#36f6066b7c1cdd9298d4e49c8e3aae04">00751</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#36f6066b7c1cdd9298d4e49c8e3aae04">OnEditProfileMenu</a>(self, event):
<a name="l00752"></a>00752         title = <span class="stringliteral">"Edit %s Profile"</span>%self.Manager.GetCurrentProfileName()
<a name="l00753"></a>00753         dictionary,current = self.Manager.GetCurrentProfileLists()
<a name="l00754"></a>00754         self.EditProfile(title, dictionary, current)
<a name="l00755"></a>00755         event.Skip()
<a name="l00756"></a>00756     
<a name="l00757"></a><a class="code" href="namespacenetworkedit.html#5bab65ca0184167cc1b28511385d3222">00757</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#5bab65ca0184167cc1b28511385d3222">EditProfile</a>(self, title, dictionary, current):
<a name="l00758"></a>00758         dialog = CommunicationDialog(self)
<a name="l00759"></a>00759         dialog.SetTitle(title)
<a name="l00760"></a>00760         dialog.SetIndexDictionary(dictionary)
<a name="l00761"></a>00761         dialog.SetCurrentList(current)
<a name="l00762"></a>00762         dialog.RefreshLists()
<a name="l00763"></a>00763         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00764"></a>00764             new_profile = dialog.GetCurrentList()
<a name="l00765"></a>00765             addinglist = []
<a name="l00766"></a>00766             removinglist = []
<a name="l00767"></a>00767             <span class="keywordflow">for</span> index <span class="keywordflow">in</span> new_profile:
<a name="l00768"></a>00768                 <span class="keywordflow">if</span> index <span class="keywordflow">not</span> <span class="keywordflow">in</span> current:
<a name="l00769"></a>00769                     addinglist.append(index)
<a name="l00770"></a>00770             <span class="keywordflow">for</span> index <span class="keywordflow">in</span> current:
<a name="l00771"></a>00771                 <span class="keywordflow">if</span> index <span class="keywordflow">not</span> <span class="keywordflow">in</span> new_profile:
<a name="l00772"></a>00772                     removinglist.append(index)
<a name="l00773"></a>00773             self.Manager.ManageEntriesOfCurrent(addinglist, removinglist)
<a name="l00774"></a>00774             self.Manager.GenerateMapList()
<a name="l00775"></a>00775             self.Manager.BufferCurrentNode()
<a name="l00776"></a>00776             self.RefreshBufferState()
<a name="l00777"></a>00777             self.RefreshCurrentIndexList()
<a name="l00778"></a>00778         dialog.Destroy()
<a name="l00779"></a>00779 
<a name="l00780"></a>00780 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00781"></a>00781 <span class="comment">#                         Edit Node informations function</span>
<a name="l00782"></a>00782 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00783"></a>00783 
<a name="l00784"></a><a class="code" href="namespacenetworkedit.html#45c1bba6fe5ef90e41730de7039a937b">00784</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#45c1bba6fe5ef90e41730de7039a937b">OnNodeInfosMenu</a>(self, event):
<a name="l00785"></a>00785         dialog = NodeInfosDialog(self)
<a name="l00786"></a>00786         name, id, type, description = self.Manager.GetCurrentNodeInfos()
<a name="l00787"></a>00787         dialog.SetValues(name, id, type, description)
<a name="l00788"></a>00788         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00789"></a>00789             name, id, type, description = dialog.GetValues()
<a name="l00790"></a>00790             self.Manager.SetCurrentNodeInfos(name, id, type, description)
<a name="l00791"></a>00791             self.RefreshBufferState()
<a name="l00792"></a>00792             self.RefreshProfileMenu()
<a name="l00793"></a>00793             selected = self.FileOpened.GetSelection()
<a name="l00794"></a>00794             <span class="keywordflow">if</span> selected &gt;= 0:
<a name="l00795"></a>00795                 window = self.FileOpened.GetPage(selected)
<a name="l00796"></a>00796                 window.RefreshTable()
<a name="l00797"></a>00797         event.Skip()
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00801"></a>00801 <span class="comment">#                           Add User Types and Variables</span>
<a name="l00802"></a>00802 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00803"></a>00803         
<a name="l00804"></a><a class="code" href="namespacenetworkedit.html#3b5726dbbad16c70542eb1a795e98dfb">00804</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#3b5726dbbad16c70542eb1a795e98dfb">AddMapVariable</a>(self):
<a name="l00805"></a>00805         index = self.Manager.GetCurrentNextMapIndex()
<a name="l00806"></a>00806         <span class="keywordflow">if</span> index:
<a name="l00807"></a>00807             dialog = MapVariableDialog(self)
<a name="l00808"></a>00808             dialog.SetIndex(index)
<a name="l00809"></a>00809             <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00810"></a>00810                 index, name, struct, number = dialog.GetValues()
<a name="l00811"></a>00811                 result = self.Manager.AddMapVariableToCurrent(index, name, struct, number)
<a name="l00812"></a>00812                 <span class="keywordflow">if</span> type(result) != StringType:
<a name="l00813"></a>00813                     self.RefreshBufferState()
<a name="l00814"></a>00814                     self.RefreshCurrentIndexList()
<a name="l00815"></a>00815                 <span class="keywordflow">else</span>:
<a name="l00816"></a>00816                     message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00817"></a>00817                     message.ShowModal()
<a name="l00818"></a>00818                     message.Destroy()
<a name="l00819"></a>00819             dialog.Destroy()
<a name="l00820"></a>00820         <span class="keywordflow">else</span>:
<a name="l00821"></a>00821             message = wxMessageDialog(self, result, <span class="stringliteral">"No map variable index left!"</span>, wxOK|wxICON_ERROR)
<a name="l00822"></a>00822             message.ShowModal()
<a name="l00823"></a>00823             message.Destroy()
<a name="l00824"></a>00824         
<a name="l00825"></a><a class="code" href="namespacenetworkedit.html#29fd99e799c36ab2f01061e1752c89c9">00825</a>     <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#29fd99e799c36ab2f01061e1752c89c9">AddUserType</a>(self):
<a name="l00826"></a>00826         dialog = UserTypeDialog(self)
<a name="l00827"></a>00827         dialog.SetTypeList(self.Manager.GetCustomisableTypes())
<a name="l00828"></a>00828         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00829"></a>00829             type, min, max, length = dialog.GetValues()
<a name="l00830"></a>00830             result = self.Manager.AddUserTypeToCurrent(type, min, max, length)
<a name="l00831"></a>00831             <span class="keywordflow">if</span> <span class="keywordflow">not</span> IsOfType(result, StringType):
<a name="l00832"></a>00832                 self.RefreshBufferState()
<a name="l00833"></a>00833                 self.RefreshCurrentIndexList()
<a name="l00834"></a>00834             <span class="keywordflow">else</span>:
<a name="l00835"></a>00835                 message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00836"></a>00836                 message.ShowModal()
<a name="l00837"></a>00837                 message.Destroy()
<a name="l00838"></a>00838         dialog.Destroy()
<a name="l00839"></a>00839 
<a name="l00840"></a>00840 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00841"></a>00841 <span class="comment">#                               Exception Handler</span>
<a name="l00842"></a>00842 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 Max_Traceback_List_Size = 20
<a name="l00845"></a>00845 
<a name="l00846"></a><a class="code" href="namespacenetworkedit.html#001372e9d0f0b0629c6516977265dcbc">00846</a> <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#001372e9d0f0b0629c6516977265dcbc">Display_Exception_Dialog</a>(e_type,e_value,e_tb):
<a name="l00847"></a>00847     trcbck_lst = []
<a name="l00848"></a>00848     <span class="keywordflow">for</span> i,line <span class="keywordflow">in</span> enumerate(traceback.extract_tb(e_tb)):
<a name="l00849"></a>00849         trcbck = <span class="stringliteral">" "</span> + str(i+1) + <span class="stringliteral">". "</span>
<a name="l00850"></a>00850         <span class="keywordflow">if</span> line[0].find(os.getcwd()) == -1:
<a name="l00851"></a>00851             trcbck += <span class="stringliteral">"file : "</span> + str(line[0]) + <span class="stringliteral">",   "</span>
<a name="l00852"></a>00852         <span class="keywordflow">else</span>:
<a name="l00853"></a>00853             trcbck += <span class="stringliteral">"file : "</span> + str(line[0][len(os.getcwd()):]) + <span class="stringliteral">",   "</span>
<a name="l00854"></a>00854         trcbck += <span class="stringliteral">"line : "</span> + str(line[1]) + <span class="stringliteral">",   "</span> + <span class="stringliteral">"function : "</span> + str(line[2])
<a name="l00855"></a>00855         trcbck_lst.append(trcbck)
<a name="l00856"></a>00856         
<a name="l00857"></a>00857     <span class="comment"># Allow clicking....</span>
<a name="l00858"></a>00858     cap = wx.Window_GetCapture()
<a name="l00859"></a>00859     <span class="keywordflow">if</span> cap:
<a name="l00860"></a>00860         cap.ReleaseMouse()
<a name="l00861"></a>00861 
<a name="l00862"></a>00862     dlg = wx.SingleChoiceDialog(<span class="keywordtype">None</span>, 
<a name="l00863"></a>00863         <span class="stringliteral">"""</span>
<a name="l00864"></a>00864 <span class="stringliteral">An error happens.</span>
<a name="l00865"></a>00865 <span class="stringliteral"></span>
<a name="l00866"></a>00866 <span class="stringliteral">Click on OK for saving an error report.</span>
<a name="l00867"></a>00867 <span class="stringliteral"></span>
<a name="l00868"></a>00868 <span class="stringliteral">Please contact LOLITech at:</span>
<a name="l00869"></a>00869 <span class="stringliteral">+33 (0)3 29 52 95 67</span>
<a name="l00870"></a>00870 <span class="stringliteral">bugs_networkedit@lolitech.fr</span>
<a name="l00871"></a>00871 <span class="stringliteral"></span>
<a name="l00872"></a>00872 <span class="stringliteral"></span>
<a name="l00873"></a>00873 <span class="stringliteral">Error:</span>
<a name="l00874"></a>00874 <span class="stringliteral">"""</span> +
<a name="l00875"></a>00875         str(e_type) + <span class="stringliteral">" : "</span> + str(e_value), 
<a name="l00876"></a>00876         <span class="stringliteral">"Error"</span>,
<a name="l00877"></a>00877         trcbck_lst)
<a name="l00878"></a>00878     <span class="keywordflow">try</span>:
<a name="l00879"></a>00879         res = (dlg.ShowModal() == wx.ID_OK)
<a name="l00880"></a>00880     <span class="keywordflow">finally</span>:
<a name="l00881"></a>00881         dlg.Destroy()
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="keywordflow">return</span> res
<a name="l00884"></a>00884 
<a name="l00885"></a><a class="code" href="namespacenetworkedit.html#f360c16d50fb1b076b07b3ea901302ac">00885</a> <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#f360c16d50fb1b076b07b3ea901302ac">Display_Error_Dialog</a>(e_value):
<a name="l00886"></a>00886     message = wxMessageDialog(<span class="keywordtype">None</span>, str(e_value), <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00887"></a>00887     message.ShowModal()
<a name="l00888"></a>00888     message.Destroy()
<a name="l00889"></a>00889 
<a name="l00890"></a><a class="code" href="namespacenetworkedit.html#94d508d0c774a0e391694ebcaa664b96">00890</a> <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#94d508d0c774a0e391694ebcaa664b96">get_last_traceback</a>(tb):
<a name="l00891"></a>00891     <span class="keywordflow">while</span> tb.tb_next:
<a name="l00892"></a>00892         tb = tb.tb_next
<a name="l00893"></a>00893     <span class="keywordflow">return</span> tb
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 
<a name="l00896"></a><a class="code" href="namespacenetworkedit.html#9e8150613da488877091ed43d4892554">00896</a> <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#9e8150613da488877091ed43d4892554">format_namespace</a>(d, indent='    '):
<a name="l00897"></a>00897     <span class="keywordflow">return</span> <span class="stringliteral">'\n'</span>.join([<span class="stringliteral">'%s%s: %s'</span> % (indent, k, repr(v)[:10000]) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> d.iteritems()])
<a name="l00898"></a>00898 
<a name="l00899"></a>00899 
<a name="l00900"></a>00900 ignored_exceptions = [] <span class="comment"># a problem with a line in a module is only reported once per session</span>
<a name="l00901"></a>00901 
<a name="l00902"></a><a class="code" href="namespacenetworkedit.html#5c3ac4301719e50188f9d6fbfe9d140d">00902</a> <span class="keyword">def </span><a class="code" href="namespacenetworkedit.html#5c3ac4301719e50188f9d6fbfe9d140d">wxAddExceptHook</a>(path, app_version='[No version]'):<span class="comment">#, ignored_exceptions=[]):</span>
<a name="l00903"></a>00903     
<a name="l00904"></a>00904     <span class="keyword">def </span>handle_exception(e_type, e_value, e_traceback):
<a name="l00905"></a>00905         traceback.print_exception(e_type, e_value, e_traceback) <span class="comment"># this is very helpful when there's an exception in the rest of this func</span>
<a name="l00906"></a>00906         last_tb = get_last_traceback(e_traceback)
<a name="l00907"></a>00907         ex = (last_tb.tb_frame.f_code.co_filename, last_tb.tb_frame.f_lineno)
<a name="l00908"></a>00908         <span class="keywordflow">if</span> str(e_value).startswith(<span class="stringliteral">"!!!"</span>):
<a name="l00909"></a>00909             Display_Error_Dialog(e_value)
<a name="l00910"></a>00910         <span class="keywordflow">elif</span> ex <span class="keywordflow">not</span> <span class="keywordflow">in</span> ignored_exceptions:
<a name="l00911"></a>00911             ignored_exceptions.append(ex)
<a name="l00912"></a>00912             result = Display_Exception_Dialog(e_type,e_value,e_traceback)
<a name="l00913"></a>00913             <span class="keywordflow">if</span> result:
<a name="l00914"></a>00914                 info = {
<a name="l00915"></a>00915                     <span class="stringliteral">'app-title'</span> : wx.GetApp().GetAppName(), <span class="comment"># app_title</span>
<a name="l00916"></a>00916                     <span class="stringliteral">'app-version'</span> : app_version,
<a name="l00917"></a>00917                     <span class="stringliteral">'wx-version'</span> : wx.VERSION_STRING,
<a name="l00918"></a>00918                     <span class="stringliteral">'wx-platform'</span> : wx.Platform,
<a name="l00919"></a>00919                     <span class="stringliteral">'python-version'</span> : platform.python_version(), <span class="comment">#sys.version.split()[0],</span>
<a name="l00920"></a>00920                     <span class="stringliteral">'platform'</span> : platform.platform(),
<a name="l00921"></a>00921                     <span class="stringliteral">'e-type'</span> : e_type,
<a name="l00922"></a>00922                     <span class="stringliteral">'e-value'</span> : e_value,
<a name="l00923"></a>00923                     <span class="stringliteral">'date'</span> : time.ctime(),
<a name="l00924"></a>00924                     <span class="stringliteral">'cwd'</span> : os.getcwd(),
<a name="l00925"></a>00925                     }
<a name="l00926"></a>00926                 <span class="keywordflow">if</span> e_traceback:
<a name="l00927"></a>00927                     info[<span class="stringliteral">'traceback'</span>] = <span class="stringliteral">''</span>.join(traceback.format_tb(e_traceback)) + <span class="stringliteral">'%s: %s'</span> % (e_type, e_value)
<a name="l00928"></a>00928                     last_tb = get_last_traceback(e_traceback)
<a name="l00929"></a>00929                     exception_locals = last_tb.tb_frame.f_locals <span class="comment"># the locals at the level of the stack trace where the exception actually occurred</span>
<a name="l00930"></a>00930                     info[<span class="stringliteral">'locals'</span>] = format_namespace(exception_locals)
<a name="l00931"></a>00931                     <span class="keywordflow">if</span> <span class="stringliteral">'self'</span> <span class="keywordflow">in</span> exception_locals:
<a name="l00932"></a>00932                         info[<span class="stringliteral">'self'</span>] = format_namespace(exception_locals[<span class="stringliteral">'self'</span>].__dict__)
<a name="l00933"></a>00933                 
<a name="l00934"></a>00934                 output = open(path+os.sep+<span class="stringliteral">"bug_report_"</span>+info[<span class="stringliteral">'date'</span>].replace(<span class="stringliteral">':'</span>,<span class="stringliteral">'-'</span>).replace(<span class="stringliteral">' '</span>,<span class="stringliteral">'_'</span>)+<span class="stringliteral">".txt"</span>,<span class="stringliteral">'w'</span>)
<a name="l00935"></a>00935                 lst = info.keys()
<a name="l00936"></a>00936                 lst.sort()
<a name="l00937"></a>00937                 <span class="keywordflow">for</span> a <span class="keywordflow">in</span> lst:
<a name="l00938"></a>00938                     output.write(a+<span class="stringliteral">":\n"</span>+str(info[a])+<span class="stringliteral">"\n\n"</span>)
<a name="l00939"></a>00939 
<a name="l00940"></a>00940     <span class="comment">#sys.excepthook = lambda *args: wx.CallAfter(handle_exception, *args)</span>
<a name="l00941"></a>00941     sys.excepthook = handle_exception
<a name="l00942"></a>00942 
<a name="l00943"></a>00943 <span class="keywordflow">if</span> __name__ == <span class="stringliteral">'__main__'</span>:
<a name="l00944"></a>00944     app = wxPySimpleApp()
<a name="l00945"></a>00945     wxInitAllImageHandlers()
<a name="l00946"></a>00946     
<a name="l00947"></a>00947     <span class="comment"># Install a exception handle for bug reports</span>
<a name="l00948"></a>00948     wxAddExceptHook(os.getcwd(),__version__)
<a name="l00949"></a>00949     
<a name="l00950"></a>00950     frame = networkedit(<span class="keywordtype">None</span>)
<a name="l00951"></a>00951 
<a name="l00952"></a>00952     frame.Show()
<a name="l00953"></a>00953     app.MainLoop()
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 4 16:29:06 2007 for CanFestival by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>

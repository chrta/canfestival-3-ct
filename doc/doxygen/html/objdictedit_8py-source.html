<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CanFestival: /home/epimerde/documents/tc11/CanFestival-3/objdictgen/objdictedit.py Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>/home/epimerde/documents/tc11/CanFestival-3/objdictgen/objdictedit.py</h1><a href="objdictedit_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespaceobjdictedit.html">00001</a> <span class="comment">#!/usr/bin/env python</span>
<a name="l00002"></a>00002 <span class="comment"># -*- coding: utf-8 -*-</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="comment">#This file is part of CanFestival, a library implementing CanOpen Stack. </span>
<a name="l00005"></a>00005 <span class="comment">#</span>
<a name="l00006"></a>00006 <span class="comment">#Copyright (C): Edouard TISSERANT, Francis DUPIN and Laurent BESSARD</span>
<a name="l00007"></a>00007 <span class="comment">#</span>
<a name="l00008"></a>00008 <span class="comment">#See COPYING file for copyrights details.</span>
<a name="l00009"></a>00009 <span class="comment">#</span>
<a name="l00010"></a>00010 <span class="comment">#This library is free software; you can redistribute it and/or</span>
<a name="l00011"></a>00011 <span class="comment">#modify it under the terms of the GNU Lesser General Public</span>
<a name="l00012"></a>00012 <span class="comment">#License as published by the Free Software Foundation; either</span>
<a name="l00013"></a>00013 <span class="comment">#version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00014"></a>00014 <span class="comment">#</span>
<a name="l00015"></a>00015 <span class="comment">#This library is distributed in the hope that it will be useful,</span>
<a name="l00016"></a>00016 <span class="comment">#but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00017"></a>00017 <span class="comment">#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00018"></a>00018 <span class="comment">#Lesser General Public License for more details.</span>
<a name="l00019"></a>00019 <span class="comment">#</span>
<a name="l00020"></a>00020 <span class="comment">#You should have received a copy of the GNU Lesser General Public</span>
<a name="l00021"></a>00021 <span class="comment">#License along with this library; if not, write to the Free Software</span>
<a name="l00022"></a>00022 <span class="comment">#Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="keyword">from</span> wxPython.wx <span class="keyword">import</span> *
<a name="l00025"></a>00025 <span class="keyword">from</span> wxPython.grid <span class="keyword">import</span> *
<a name="l00026"></a>00026 <span class="keyword">import</span> wx
<a name="l00027"></a>00027 <span class="keyword">import</span> wx.grid
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">from</span> types <span class="keyword">import</span> *
<a name="l00030"></a>00030 <span class="keyword">import</span> os, re, platform, sys, time, traceback, getopt
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 __version__ = <span class="stringliteral">"$Revision$"</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">from</span> node <span class="keyword">import</span> OD_Subindex, OD_MultipleSubindexes, OD_IdenticalSubindexes, OD_IdenticalIndexes
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="keyword">from</span> nodemanager <span class="keyword">import</span> *
<a name="l00037"></a>00037 <span class="keyword">from</span> subindextable <span class="keyword">import</span> *
<a name="l00038"></a>00038 <span class="keyword">from</span> commondialogs <span class="keyword">import</span> *
<a name="l00039"></a>00039 <span class="keyword">from</span> doc_index.DS301_index <span class="keyword">import</span> *
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="keywordflow">try</span>:
<a name="l00042"></a>00042     <span class="keyword">from</span> wxPython.html <span class="keyword">import</span> *
<a name="l00043"></a>00043 
<a name="l00044"></a>00044     wxEVT_HTML_URL_CLICK = wxNewId()
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="namespaceobjdictedit.html#6f56af22e4041461f4f3852041fd46cf">00046</a>     <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#6f56af22e4041461f4f3852041fd46cf">EVT_HTML_URL_CLICK</a>(win, func):
<a name="l00047"></a>00047         win.Connect(-1, -1, wxEVT_HTML_URL_CLICK, func)
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="classobjdictedit_1_1wxHtmlWindowUrlClick.html">00049</a>     <span class="keyword">class </span><a class="code" href="classobjdictedit_1_1wxHtmlWindowUrlClick.html">wxHtmlWindowUrlClick</a>(wxPyEvent):
<a name="l00050"></a><a class="code" href="classobjdictedit_1_1wxHtmlWindowUrlClick.html#a045fe12f2047ab57620eeaaaa2f211e">00050</a>         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxHtmlWindowUrlClick.html#a045fe12f2047ab57620eeaaaa2f211e">__init__</a>(self, linkinfo):
<a name="l00051"></a>00051             wxPyEvent.__init__(self)
<a name="l00052"></a>00052             self.SetEventType(wxEVT_HTML_URL_CLICK)
<a name="l00053"></a><a class="code" href="classobjdictedit_1_1wxHtmlWindowUrlClick.html#6a78aa98e9dcf8a31aa79b429998cf46">00053</a>             self.<a class="code" href="classobjdictedit_1_1wxHtmlWindowUrlClick.html#6a78aa98e9dcf8a31aa79b429998cf46">linkinfo</a>linkinfo = (linkinfo.GetHref(), linkinfo.GetTarget())
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow.html">00055</a>     <span class="keyword">class </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow.html">wxUrlClickHtmlWindow</a>(wxHtmlWindow):
<a name="l00056"></a>00056         <span class="stringliteral">""" HTML window that generates and OnLinkClicked event.</span>
<a name="l00057"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow.html#7cd4af390c2de4ed45de931373d756f0">00057</a> <span class="stringliteral"></span>
<a name="l00058"></a>00058 <span class="stringliteral">        Use this to avoid having to override HTMLWindow</span>
<a name="l00059"></a>00059 <span class="stringliteral">        """</span>
<a name="l00060"></a>00060         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow.html#7cd4af390c2de4ed45de931373d756f0">OnLinkClicked</a>(self, linkinfo):
<a name="l00061"></a>00061             wxPostEvent(self, wxHtmlWindowUrlClick(linkinfo))
<a name="l00062"></a>00062     
<a name="l00063"></a>00063 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00064"></a>00064 <span class="comment">#                                Html Frame</span>
<a name="l00065"></a>00065 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00066"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html">00066</a> 
<a name="l00067"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#ab7f53a3b3ff1fd9cfe56023b159a40e">00067</a>     [wxID_HTMLFRAME, wxID_HTMLFRAMEHTMLCONTENT] = [wx.NewId() <span class="keywordflow">for</span> _init_ctrls <span class="keywordflow">in</span> range(2)]
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     <span class="keyword">class </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html">HtmlFrame</a>(wx.Frame):
<a name="l00070"></a>00070         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#ab7f53a3b3ff1fd9cfe56023b159a40e">_init_ctrls</a>(self, prnt):
<a name="l00071"></a>00071             <span class="comment"># generated method, don't edit</span>
<a name="l00072"></a>00072             wx.Frame.__init__(self, id=wxID_HTMLFRAME, name=<span class="stringliteral">'HtmlFrame'</span>,
<a name="l00073"></a>00073                   parent=prnt, pos=wx.Point(320, 231), size=wx.Size(853, 616),
<a name="l00074"></a>00074                   style=wx.DEFAULT_FRAME_STYLE, title=<span class="stringliteral">''</span>)
<a name="l00075"></a>00075             self.Bind(wx.EVT_CLOSE, self.<a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#5cadc14f91eaeef5c2e001ccdf408264">OnCloseFrame</a>OnCloseFrame, id=wxID_HTMLFRAME)
<a name="l00076"></a>00076             
<a name="l00077"></a>00077             self.HtmlContent = wxUrlClickHtmlWindow(id=wxID_HTMLFRAMEHTMLCONTENT,
<a name="l00078"></a>00078                   name=<span class="stringliteral">'HtmlContent'</span>, parent=self, pos=wx.Point(0, 0),
<a name="l00079"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#c3eab7be0bc1afb27171837c712da89d">00079</a>                   size=wx.Size(-1, -1), style=wxHW_SCROLLBAR_AUTO|wxHW_NO_SELECTION)
<a name="l00080"></a>00080             EVT_HTML_URL_CLICK(self.HtmlContent, self.<a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#bf60307dc144170d58195467361d5aa4">OnLinkClick</a>OnLinkClick)
<a name="l00081"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#1eafdd26ade3a7888626bee2f19a5ce4">00081</a> 
<a name="l00082"></a>00082         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#c3eab7be0bc1afb27171837c712da89d">__init__</a>(self, parent, opened):
<a name="l00083"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#375043f928e987f104763ad6e3d118be">00083</a>             self.<a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#ab7f53a3b3ff1fd9cfe56023b159a40e">_init_ctrls</a>_init_ctrls(parent)
<a name="l00084"></a>00084             self.<a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#1eafdd26ade3a7888626bee2f19a5ce4">HtmlFrameOpened</a>HtmlFrameOpened = opened
<a name="l00085"></a>00085         
<a name="l00086"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#d55f13d2f73906fb8891fd8ab6282897">00086</a>         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#375043f928e987f104763ad6e3d118be">SetHtmlCode</a>(self, htmlcode):
<a name="l00087"></a>00087             self.HtmlContent.SetPage(htmlcode)
<a name="l00088"></a>00088             
<a name="l00089"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#5cadc14f91eaeef5c2e001ccdf408264">00089</a>         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#d55f13d2f73906fb8891fd8ab6282897">SetHtmlPage</a>(self, htmlpage):
<a name="l00090"></a>00090             self.HtmlContent.LoadPage(htmlpage)
<a name="l00091"></a>00091             
<a name="l00092"></a>00092         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#5cadc14f91eaeef5c2e001ccdf408264">OnCloseFrame</a>(self, event):
<a name="l00093"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#bf60307dc144170d58195467361d5aa4">00093</a>             self.<a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#1eafdd26ade3a7888626bee2f19a5ce4">HtmlFrameOpened</a>HtmlFrameOpened.remove(self.GetTitle())
<a name="l00094"></a>00094             event.Skip()
<a name="l00095"></a>00095         
<a name="l00096"></a>00096         <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow_1_1HtmlFrame.html#bf60307dc144170d58195467361d5aa4">OnLinkClick</a>(self, event):
<a name="l00097"></a>00097             url = event.linkinfo[0]
<a name="l00098"></a>00098             <span class="keywordflow">try</span>:
<a name="l00099"></a>00099                 <span class="keyword">import</span> webbrowser
<a name="l00100"></a>00100             <span class="keywordflow">except</span> ImportError:
<a name="l00101"></a>00101                 wxMessageBox(<span class="stringliteral">'Please point your browser at: %s'</span> % url)
<a name="l00102"></a><a class="code" href="classobjdictedit_1_1wxUrlClickHtmlWindow.html#1de5f92921afa89cfe93fe8a6837dedb">00102</a>             <span class="keywordflow">else</span>:
<a name="l00103"></a>00103                 webbrowser.open(url)
<a name="l00104"></a>00104     
<a name="l00105"></a>00105     Html_Window = <span class="keyword">True</span>
<a name="l00106"></a>00106 <span class="keywordflow">except</span>:
<a name="l00107"></a>00107     Html_Window = <span class="keyword">False</span>
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="namespaceobjdictedit.html#6676940963fc8d2458cc3df0739cc43f">00109</a> <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#6676940963fc8d2458cc3df0739cc43f">create</a>(parent):
<a name="l00110"></a>00110     <span class="keywordflow">return</span> objdictedit(parent)
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="namespaceobjdictedit.html#32e0bb76ebce2730cbb78c694b11e015">00112</a> <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#32e0bb76ebce2730cbb78c694b11e015">usage</a>():
<a name="l00113"></a>00113     <span class="keywordflow">print</span> <span class="stringliteral">"\nUsage of objdictedit.py :"</span>
<a name="l00114"></a>00114     <span class="keywordflow">print</span> <span class="stringliteral">"\n   %s [Filepath, ...]\n"</span>%sys.argv[0]
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="keywordflow">try</span>:
<a name="l00117"></a>00117     opts, args = getopt.getopt(sys.argv[1:], <span class="stringliteral">"h"</span>, [<span class="stringliteral">"help"</span>])
<a name="l00118"></a>00118 <span class="keywordflow">except</span> getopt.GetoptError:
<a name="l00119"></a>00119     <span class="comment"># print help information and exit:</span>
<a name="l00120"></a>00120     usage()
<a name="l00121"></a>00121     sys.exit(2)
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="keywordflow">for</span> o, a <span class="keywordflow">in</span> opts:
<a name="l00124"></a>00124     <span class="keywordflow">if</span> o <span class="keywordflow">in</span> (<span class="stringliteral">"-h"</span>, <span class="stringliteral">"--help"</span>):
<a name="l00125"></a>00125         usage()
<a name="l00126"></a>00126         sys.exit()
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 filesOpen = args
<a name="l00129"></a>00129 ScriptDirectory = sys.path[0]
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 [wxID_OBJDICTEDIT, wxID_OBJDICTEDITFILEOPENED, 
<a name="l00133"></a>00133  wxID_OBJDICTEDITHELPBAR,
<a name="l00134"></a>00134 ] = [wx.NewId() <span class="keywordflow">for</span> _init_ctrls <span class="keywordflow">in</span> range(3)]
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 [wxID_OBJDICTEDITADDMENUITEMS0, wxID_OBJDICTEDITADDMENUITEMS1, 
<a name="l00137"></a>00137  wxID_OBJDICTEDITADDMENUITEMS2, wxID_OBJDICTEDITADDMENUITEMS3, 
<a name="l00138"></a>00138  wxID_OBJDICTEDITADDMENUITEMS4, wxID_OBJDICTEDITADDMENUITEMS5, 
<a name="l00139"></a>00139 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_AddMenu_Items <span class="keywordflow">in</span> range(6)]
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 [wxID_OBJDICTEDITFILEMENUITEMS0, wxID_OBJDICTEDITFILEMENUITEMS1, 
<a name="l00142"></a>00142  wxID_OBJDICTEDITFILEMENUITEMS2, wxID_OBJDICTEDITFILEMENUITEMS4, 
<a name="l00143"></a>00143  wxID_OBJDICTEDITFILEMENUITEMS5, wxID_OBJDICTEDITFILEMENUITEMS6, 
<a name="l00144"></a>00144  wxID_OBJDICTEDITFILEMENUITEMS7, wxID_OBJDICTEDITFILEMENUITEMS8,
<a name="l00145"></a>00145  wxID_OBJDICTEDITFILEMENUITEMS9,
<a name="l00146"></a>00146 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_FileMenu_Items <span class="keywordflow">in</span> range(9)]
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 [wxID_OBJDICTEDITEDITMENUITEMS0, wxID_OBJDICTEDITEDITMENUITEMS1, 
<a name="l00149"></a>00149  wxID_OBJDICTEDITEDITMENUITEMS2, wxID_OBJDICTEDITEDITMENUITEMS4, 
<a name="l00150"></a>00150  wxID_OBJDICTEDITEDITMENUITEMS6, wxID_OBJDICTEDITEDITMENUITEMS7, 
<a name="l00151"></a>00151  wxID_OBJDICTEDITEDITMENUITEMS8, 
<a name="l00152"></a>00152 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_EditMenu_Items <span class="keywordflow">in</span> range(7)]
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 [wxID_OBJDICTEDITHELPMENUITEMS0, wxID_OBJDICTEDITHELPMENUITEMS1,
<a name="l00155"></a>00155  wxID_OBJDICTEDITHELPMENUITEMS2,
<a name="l00156"></a>00156 ] = [wx.NewId() <span class="keywordflow">for</span> _init_coll_HelpMenu_Items <span class="keywordflow">in</span> range(3)]
<a name="l00157"></a>00157 
<a name="l00158"></a><a class="code" href="classobjdictedit_1_1objdictedit.html">00158</a> <span class="keyword">class </span><a class="code" href="classobjdictedit_1_1objdictedit.html">objdictedit</a>(wx.Frame):
<a name="l00159"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#106e911cf82219438516ee23864651ec">00159</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#106e911cf82219438516ee23864651ec">_init_coll_menuBar1_Menus</a>(self, parent):
<a name="l00160"></a>00160         <span class="comment"># generated method, don't edit</span>
<a name="l00161"></a>00161 
<a name="l00162"></a>00162         parent.Append(menu=self.FileMenu, title=<span class="stringliteral">'File'</span>)
<a name="l00163"></a>00163         parent.Append(menu=self.EditMenu, title=<span class="stringliteral">'Edit'</span>)
<a name="l00164"></a>00164         parent.Append(menu=self.AddMenu, title=<span class="stringliteral">'Add'</span>)
<a name="l00165"></a>00165         parent.Append(menu=self.HelpMenu, title=<span class="stringliteral">'Help'</span>)
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#ff8d7ea6744ddf274fc66869b0dd8d5d">00167</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#ff8d7ea6744ddf274fc66869b0dd8d5d">_init_coll_EditMenu_Items</a>(self, parent):
<a name="l00168"></a>00168         <span class="comment"># generated method, don't edit</span>
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITEDITMENUITEMS4,
<a name="l00171"></a>00171               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Refresh\tCTRL+R'</span>)
<a name="l00172"></a>00172         parent.AppendSeparator()
<a name="l00173"></a>00173         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITEDITMENUITEMS1,
<a name="l00174"></a>00174               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Undo\tCTRL+Z'</span>)
<a name="l00175"></a>00175         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITEDITMENUITEMS0,
<a name="l00176"></a>00176               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Redo\tCTRL+Y'</span>)
<a name="l00177"></a>00177         parent.AppendSeparator()
<a name="l00178"></a>00178         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITEDITMENUITEMS6,
<a name="l00179"></a>00179               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Node infos'</span>)
<a name="l00180"></a>00180         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITEDITMENUITEMS2,
<a name="l00181"></a>00181               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'DS-301 Profile'</span>)
<a name="l00182"></a>00182         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITEDITMENUITEMS8,
<a name="l00183"></a>00183               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'DS-302 Profile'</span>)
<a name="l00184"></a>00184         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITEDITMENUITEMS7,
<a name="l00185"></a>00185               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Other Profile'</span>)
<a name="l00186"></a>00186         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#264a8c0092529d669e103a0e08bfa759">OnUndoMenu</a>OnUndoMenu,
<a name="l00187"></a>00187               id=wxID_OBJDICTEDITEDITMENUITEMS1)
<a name="l00188"></a>00188         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#e864e63ae5efdb88512d02c0e51d895e">OnRedoMenu</a>OnRedoMenu,
<a name="l00189"></a>00189               id=wxID_OBJDICTEDITEDITMENUITEMS0)
<a name="l00190"></a>00190         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#e1addc8fb2f5922f54e3e7805ed5d33e">OnCommunicationMenu</a>OnCommunicationMenu,
<a name="l00191"></a>00191               id=wxID_OBJDICTEDITEDITMENUITEMS2)
<a name="l00192"></a>00192         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#88ca3cd196a27f86a3253599b588ee4c">OnRefreshMenu</a>OnRefreshMenu,
<a name="l00193"></a>00193               id=wxID_OBJDICTEDITEDITMENUITEMS4)
<a name="l00194"></a>00194         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#3bc819e548d22a2487aa70a0f3e6cbb4">OnNodeInfosMenu</a>OnNodeInfosMenu,
<a name="l00195"></a>00195               id=wxID_OBJDICTEDITEDITMENUITEMS6)
<a name="l00196"></a>00196         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#e807650522769539794ab076713098e2">OnEditProfileMenu</a>OnEditProfileMenu,
<a name="l00197"></a>00197               id=wxID_OBJDICTEDITEDITMENUITEMS7)
<a name="l00198"></a>00198         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#01f0b410972b6c480f6eac6448aca0e6">OnOtherCommunicationMenu</a>OnOtherCommunicationMenu,
<a name="l00199"></a>00199               id=wxID_OBJDICTEDITEDITMENUITEMS8)
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#d939c47145a0e3275963bde016228f28">00201</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#d939c47145a0e3275963bde016228f28">_init_coll_HelpMenu_Items</a>(self, parent):
<a name="l00202"></a>00202         <span class="comment"># generated method, don't edit</span>
<a name="l00203"></a>00203 
<a name="l00204"></a>00204         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITHELPMENUITEMS0,
<a name="l00205"></a>00205               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'DS-301 Standard\tF1'</span>)
<a name="l00206"></a>00206         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#8b0876dac5e3046f93854665bd9be3aa">OnHelpDS301Menu</a>OnHelpDS301Menu,
<a name="l00207"></a>00207               id=wxID_OBJDICTEDITHELPMENUITEMS0)
<a name="l00208"></a>00208         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITHELPMENUITEMS1,
<a name="l00209"></a>00209               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'CAN Festival Docs\tF2'</span>)
<a name="l00210"></a>00210         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#a498874fef86060832c7e90b6e028629">OnHelpCANFestivalMenu</a>OnHelpCANFestivalMenu,
<a name="l00211"></a>00211               id=wxID_OBJDICTEDITHELPMENUITEMS1)
<a name="l00212"></a>00212         <span class="keywordflow">if</span> Html_Window:
<a name="l00213"></a>00213             parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITHELPMENUITEMS2,
<a name="l00214"></a>00214                   kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'About'</span>)
<a name="l00215"></a>00215             self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#a660005de7e719ce7396beeea0ece661">OnAboutMenu</a>OnAboutMenu,
<a name="l00216"></a>00216                   id=wxID_OBJDICTEDITHELPMENUITEMS2)
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#8312a8842d9983e18f47e32cb66a4cbd">00218</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#8312a8842d9983e18f47e32cb66a4cbd">_init_coll_FileMenu_Items</a>(self, parent):
<a name="l00219"></a>00219         <span class="comment"># generated method, don't edit</span>
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS5,
<a name="l00222"></a>00222               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'New\tCTRL+N'</span>)
<a name="l00223"></a>00223         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS0,
<a name="l00224"></a>00224               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Open\tCTRL+O'</span>)
<a name="l00225"></a>00225         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS1,
<a name="l00226"></a>00226               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Save\tCTRL+S'</span>)
<a name="l00227"></a>00227         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS6,
<a name="l00228"></a>00228               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Save As...\tALT+S'</span>)
<a name="l00229"></a>00229         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS2,
<a name="l00230"></a>00230               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Close\tCTRL+W'</span>)
<a name="l00231"></a>00231         parent.AppendSeparator()
<a name="l00232"></a>00232         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS7,
<a name="l00233"></a>00233               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Import EDS file'</span>)
<a name="l00234"></a>00234         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS9,
<a name="l00235"></a>00235               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Export to EDS file'</span>)
<a name="l00236"></a>00236         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS8,
<a name="l00237"></a>00237               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Build Dictionary\tCTRL+B'</span>)
<a name="l00238"></a>00238         parent.AppendSeparator()
<a name="l00239"></a>00239         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITFILEMENUITEMS4,
<a name="l00240"></a>00240               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Exit'</span>)
<a name="l00241"></a>00241         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#98335ef3e9581fd3915a23d40b7f66c0">OnOpenMenu</a>OnOpenMenu,
<a name="l00242"></a>00242               id=wxID_OBJDICTEDITFILEMENUITEMS0)
<a name="l00243"></a>00243         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#4ec2a606f003b9428515bc47a63f549b">OnSaveMenu</a>OnSaveMenu,
<a name="l00244"></a>00244               id=wxID_OBJDICTEDITFILEMENUITEMS1)
<a name="l00245"></a>00245         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#a4c7476aa37450fef74c824201044c3b">OnCloseMenu</a>OnCloseMenu,
<a name="l00246"></a>00246               id=wxID_OBJDICTEDITFILEMENUITEMS2)
<a name="l00247"></a>00247         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#bb517a0b8fd0e43f1a1d68c7ce372ac3">OnQuitMenu</a>OnQuitMenu,
<a name="l00248"></a>00248               id=wxID_OBJDICTEDITFILEMENUITEMS4)
<a name="l00249"></a>00249         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#40237739c2edecc9ba933051404a5c61">OnNewMenu</a>OnNewMenu,
<a name="l00250"></a>00250               id=wxID_OBJDICTEDITFILEMENUITEMS5)
<a name="l00251"></a>00251         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#4120aa522383dd8fe88df46672e1464c">OnSaveAsMenu</a>OnSaveAsMenu,
<a name="l00252"></a>00252               id=wxID_OBJDICTEDITFILEMENUITEMS6)
<a name="l00253"></a>00253         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#8382d1464dd6a162f97040adc166251e">OnImportEDSMenu</a>OnImportEDSMenu,
<a name="l00254"></a>00254               id=wxID_OBJDICTEDITFILEMENUITEMS7)
<a name="l00255"></a>00255         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#bf3d84bab96fcc04254a602c33fbbbee">OnExportCMenu</a>OnExportCMenu,
<a name="l00256"></a>00256               id=wxID_OBJDICTEDITFILEMENUITEMS8)
<a name="l00257"></a>00257         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#29636fcd3f8f738404b6b99f93f04490">OnExportEDSMenu</a>OnExportEDSMenu,
<a name="l00258"></a>00258               id=wxID_OBJDICTEDITFILEMENUITEMS9)
<a name="l00259"></a>00259 
<a name="l00260"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#08471670ebefa572813c703c693d367c">00260</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#08471670ebefa572813c703c693d367c">_init_coll_AddMenu_Items</a>(self, parent):
<a name="l00261"></a>00261         <span class="comment"># generated method, don't edit</span>
<a name="l00262"></a>00262 
<a name="l00263"></a>00263         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITADDMENUITEMS0,
<a name="l00264"></a>00264               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'SDO Server'</span>)
<a name="l00265"></a>00265         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITADDMENUITEMS1,
<a name="l00266"></a>00266               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'SDO Client'</span>)
<a name="l00267"></a>00267         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITADDMENUITEMS2,
<a name="l00268"></a>00268               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'PDO Transmit'</span>)
<a name="l00269"></a>00269         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITADDMENUITEMS3,
<a name="l00270"></a>00270               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'PDO Receive'</span>)
<a name="l00271"></a>00271         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITADDMENUITEMS4,
<a name="l00272"></a>00272               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'Map Variable'</span>)
<a name="l00273"></a>00273         parent.Append(help=<span class="stringliteral">''</span>, id=wxID_OBJDICTEDITADDMENUITEMS5,
<a name="l00274"></a>00274               kind=wx.ITEM_NORMAL, text=<span class="stringliteral">'User Type'</span>)
<a name="l00275"></a>00275         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#2d25a6a40a74e893aebce26405a0d8f7">OnAddSDOServerMenu</a>OnAddSDOServerMenu,
<a name="l00276"></a>00276               id=wxID_OBJDICTEDITADDMENUITEMS0)
<a name="l00277"></a>00277         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#01b55597ca103c08c89d012ad6dced3d">OnAddSDOClientMenu</a>OnAddSDOClientMenu,
<a name="l00278"></a>00278               id=wxID_OBJDICTEDITADDMENUITEMS1)
<a name="l00279"></a>00279         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#cc73bf94427a95e3399e56d7f275ab77">OnAddPDOTransmitMenu</a>OnAddPDOTransmitMenu,
<a name="l00280"></a>00280               id=wxID_OBJDICTEDITADDMENUITEMS2)
<a name="l00281"></a>00281         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#a5f8ca2068f63b91c92f40f9756400f6">OnAddPDOReceiveMenu</a>OnAddPDOReceiveMenu,
<a name="l00282"></a>00282               id=wxID_OBJDICTEDITADDMENUITEMS3)
<a name="l00283"></a>00283         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#c3a4bad410a580a07dad03a4f8ba121c">OnAddMapVariableMenu</a>OnAddMapVariableMenu,
<a name="l00284"></a>00284               id=wxID_OBJDICTEDITADDMENUITEMS4)
<a name="l00285"></a>00285         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#666aae02d9569cfa32fc26329154da60">OnAddUserTypeMenu</a>OnAddUserTypeMenu,
<a name="l00286"></a>00286               id=wxID_OBJDICTEDITADDMENUITEMS5)
<a name="l00287"></a>00287 
<a name="l00288"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#31a6b686f4415521baeb49e911d05eed">00288</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#31a6b686f4415521baeb49e911d05eed">_init_coll_HelpBar_Fields</a>(self, parent):
<a name="l00289"></a>00289         <span class="comment"># generated method, don't edit</span>
<a name="l00290"></a>00290         parent.SetFieldsCount(3)
<a name="l00291"></a>00291 
<a name="l00292"></a>00292         parent.SetStatusText(number=0, text=<span class="stringliteral">''</span>)
<a name="l00293"></a>00293         parent.SetStatusText(number=1, text=<span class="stringliteral">''</span>)
<a name="l00294"></a>00294         parent.SetStatusText(number=2, text=<span class="stringliteral">''</span>)
<a name="l00295"></a>00295 
<a name="l00296"></a>00296         parent.SetStatusWidths([100, 110, -1])
<a name="l00297"></a>00297 
<a name="l00298"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#a290085c41e1c25e1393e87d171b424e">00298</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#a290085c41e1c25e1393e87d171b424e">_init_utils</a>(self):
<a name="l00299"></a>00299         <span class="comment"># generated method, don't edit</span>
<a name="l00300"></a>00300         self.menuBar1 = wx.MenuBar()
<a name="l00301"></a>00301         self.menuBar1.SetEvtHandlerEnabled(<span class="keyword">True</span>)
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         self.FileMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00304"></a>00304 
<a name="l00305"></a>00305         self.EditMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         self.AddMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         self.HelpMenu = wx.Menu(title=<span class="stringliteral">''</span>)
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#106e911cf82219438516ee23864651ec">_init_coll_menuBar1_Menus</a>_init_coll_menuBar1_Menus(self.menuBar1)
<a name="l00312"></a>00312         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#8312a8842d9983e18f47e32cb66a4cbd">_init_coll_FileMenu_Items</a>_init_coll_FileMenu_Items(self.FileMenu)
<a name="l00313"></a>00313         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#ff8d7ea6744ddf274fc66869b0dd8d5d">_init_coll_EditMenu_Items</a>_init_coll_EditMenu_Items(self.EditMenu)
<a name="l00314"></a>00314         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#08471670ebefa572813c703c693d367c">_init_coll_AddMenu_Items</a>_init_coll_AddMenu_Items(self.AddMenu)
<a name="l00315"></a>00315         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d939c47145a0e3275963bde016228f28">_init_coll_HelpMenu_Items</a>_init_coll_HelpMenu_Items(self.HelpMenu)
<a name="l00316"></a>00316 
<a name="l00317"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#1e885afd5e31d2c6be0a0e70a79b417f">00317</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#1e885afd5e31d2c6be0a0e70a79b417f">_init_ctrls</a>(self, prnt):
<a name="l00318"></a>00318         <span class="comment"># generated method, don't edit</span>
<a name="l00319"></a>00319         wx.Frame.__init__(self, id=wxID_OBJDICTEDIT, name=<span class="stringliteral">'objdictedit'</span>,
<a name="l00320"></a>00320               parent=prnt, pos=wx.Point(149, 178), size=wx.Size(1000, 700),
<a name="l00321"></a>00321               style=wx.DEFAULT_FRAME_STYLE, title=<span class="stringliteral">'Objdictedit'</span>)
<a name="l00322"></a>00322         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#a290085c41e1c25e1393e87d171b424e">_init_utils</a>_init_utils()
<a name="l00323"></a>00323         self.SetClientSize(wx.Size(1000, 700))
<a name="l00324"></a>00324         self.SetMenuBar(self.menuBar1)
<a name="l00325"></a>00325         self.Bind(wx.EVT_CLOSE, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#ef6f7560bf9be52aa312833771cfb3c9">OnCloseFrame</a>OnCloseFrame, id=wxID_OBJDICTEDIT)
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         self.FileOpened = wx.Notebook(id=wxID_OBJDICTEDITFILEOPENED,
<a name="l00328"></a>00328               name=<span class="stringliteral">'FileOpened'</span>, parent=self, pos=wx.Point(0, 0),
<a name="l00329"></a>00329               size=wx.Size(0, 0), style=0)
<a name="l00330"></a>00330         self.FileOpened.Bind(wx.EVT_NOTEBOOK_PAGE_CHANGED,
<a name="l00331"></a>00331               self.<a class="code" href="classobjdictedit_1_1objdictedit.html#8555948b7b1aecf2514b6b9ff4726635">OnFileSelectedChanged</a>OnFileSelectedChanged, id=wxID_OBJDICTEDITFILEOPENED)
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         self.HelpBar = wx.StatusBar(id=wxID_OBJDICTEDITHELPBAR, name=<span class="stringliteral">'HelpBar'</span>,
<a name="l00334"></a>00334               parent=self, style=wxST_SIZEGRIP)
<a name="l00335"></a>00335         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#31a6b686f4415521baeb49e911d05eed">_init_coll_HelpBar_Fields</a>_init_coll_HelpBar_Fields(self.HelpBar)
<a name="l00336"></a>00336         self.SetStatusBar(self.HelpBar)
<a name="l00337"></a>00337 
<a name="l00338"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#4abb1c197354d05c25e9ca9e0ad49f66">00338</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#4abb1c197354d05c25e9ca9e0ad49f66">__init__</a>(self, parent):
<a name="l00339"></a>00339         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#1e885afd5e31d2c6be0a0e70a79b417f">_init_ctrls</a>_init_ctrls(parent)
<a name="l00340"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#e3ce93c9ed275bf17437c681d5ad9692">00340</a>         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#e3ce93c9ed275bf17437c681d5ad9692">HtmlFrameOpened</a>HtmlFrameOpened = []
<a name="l00341"></a>00341         
<a name="l00342"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">00342</a>         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager = NodeManager(ScriptDirectory)
<a name="l00343"></a>00343         <span class="keywordflow">for</span> filepath <span class="keywordflow">in</span> filesOpen:
<a name="l00344"></a>00344             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.OpenFileInCurrent(filepath)
<a name="l00345"></a>00345             new_editingpanel = EditingPanel(self, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager)
<a name="l00346"></a>00346             self.FileOpened.AddPage(new_editingpanel, <span class="stringliteral">""</span>)
<a name="l00347"></a>00347             self.FileOpened.SetSelection(self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentNodeIndex())
<a name="l00348"></a>00348         <span class="keywordflow">if</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CurrentDS302Defined(): 
<a name="l00349"></a>00349             self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS8, <span class="keyword">True</span>)
<a name="l00350"></a>00350         <span class="keywordflow">else</span>:
<a name="l00351"></a>00351             self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS8, <span class="keyword">False</span>)
<a name="l00352"></a>00352         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#2b33b17be4ab0796b701fc916fcf7e64">RefreshEditMenu</a>RefreshEditMenu()
<a name="l00353"></a>00353         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00354"></a>00354         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">RefreshProfileMenu</a>RefreshProfileMenu()
<a name="l00355"></a>00355         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#ae8f91209a1bc14a0b7b7b62475d7f59">RefreshTitle</a>RefreshTitle()
<a name="l00356"></a>00356         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#adc9eb58dc3ff58afd5ff7451a62923d">RefreshMainMenu</a>RefreshMainMenu()
<a name="l00357"></a>00357 
<a name="l00358"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#38ba116f55e22e5b8e2504c44b1c9722">00358</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#38ba116f55e22e5b8e2504c44b1c9722">GetNoteBook</a>(self):
<a name="l00359"></a>00359         <span class="keywordflow">return</span> self.FileOpened
<a name="l00360"></a>00360 
<a name="l00361"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#2d25a6a40a74e893aebce26405a0d8f7">00361</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#2d25a6a40a74e893aebce26405a0d8f7">OnAddSDOServerMenu</a>(self, event):
<a name="l00362"></a>00362         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.AddSDOServerToCurrent()
<a name="l00363"></a>00363         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00364"></a>00364         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00365"></a>00365         event.Skip()
<a name="l00366"></a>00366     
<a name="l00367"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#01b55597ca103c08c89d012ad6dced3d">00367</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#01b55597ca103c08c89d012ad6dced3d">OnAddSDOClientMenu</a>(self, event):
<a name="l00368"></a>00368         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.AddSDOClientToCurrent()
<a name="l00369"></a>00369         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00370"></a>00370         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00371"></a>00371         event.Skip()
<a name="l00372"></a>00372 
<a name="l00373"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#cc73bf94427a95e3399e56d7f275ab77">00373</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#cc73bf94427a95e3399e56d7f275ab77">OnAddPDOTransmitMenu</a>(self, event):
<a name="l00374"></a>00374         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.AddPDOTransmitToCurrent()
<a name="l00375"></a>00375         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00376"></a>00376         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00377"></a>00377         event.Skip()
<a name="l00378"></a>00378 
<a name="l00379"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#a5f8ca2068f63b91c92f40f9756400f6">00379</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#a5f8ca2068f63b91c92f40f9756400f6">OnAddPDOReceiveMenu</a>(self, event):
<a name="l00380"></a>00380         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.AddPDOReceiveToCurrent()
<a name="l00381"></a>00381         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00382"></a>00382         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00383"></a>00383         event.Skip()
<a name="l00384"></a>00384 
<a name="l00385"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#c3a4bad410a580a07dad03a4f8ba121c">00385</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#c3a4bad410a580a07dad03a4f8ba121c">OnAddMapVariableMenu</a>(self, event):
<a name="l00386"></a>00386         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d320c07fd4feab969b9454d49ab0ef5a">AddMapVariable</a>AddMapVariable()
<a name="l00387"></a>00387         event.Skip()
<a name="l00388"></a>00388 
<a name="l00389"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#666aae02d9569cfa32fc26329154da60">00389</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#666aae02d9569cfa32fc26329154da60">OnAddUserTypeMenu</a>(self, event):
<a name="l00390"></a>00390         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#704a2250995855aaabdd9e024e98a1ca">AddUserType</a>AddUserType()
<a name="l00391"></a>00391         event.Skip()
<a name="l00392"></a>00392 
<a name="l00393"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#8555948b7b1aecf2514b6b9ff4726635">00393</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#8555948b7b1aecf2514b6b9ff4726635">OnFileSelectedChanged</a>(self, event):
<a name="l00394"></a>00394         selected = event.GetSelection()
<a name="l00395"></a>00395         <span class="comment"># At init selected = -1</span>
<a name="l00396"></a>00396         <span class="keywordflow">if</span> selected &gt;= 0:
<a name="l00397"></a>00397             window = self.FileOpened.GetPage(selected)
<a name="l00398"></a>00398             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.ChangeCurrentNode(window.GetIndex())
<a name="l00399"></a>00399             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00400"></a>00400             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#91f233bc35906db726537b4dc4a51d28">RefreshStatusBar</a>RefreshStatusBar()
<a name="l00401"></a>00401             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">RefreshProfileMenu</a>RefreshProfileMenu()
<a name="l00402"></a>00402         event.Skip()
<a name="l00403"></a>00403 
<a name="l00404"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#8b0876dac5e3046f93854665bd9be3aa">00404</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#8b0876dac5e3046f93854665bd9be3aa">OnHelpDS301Menu</a>(self, event):
<a name="l00405"></a>00405         find_index = <span class="keyword">False</span>
<a name="l00406"></a>00406         selected = self.FileOpened.GetSelection()
<a name="l00407"></a>00407         <span class="keywordflow">if</span> selected &gt;= 0:
<a name="l00408"></a>00408             window = self.FileOpened.GetPage(selected)
<a name="l00409"></a>00409             result = window.GetSelection()
<a name="l00410"></a>00410             <span class="keywordflow">if</span> result:
<a name="l00411"></a>00411                 find_index = <span class="keyword">True</span>
<a name="l00412"></a>00412                 index, subIndex = result
<a name="l00413"></a>00413                 result = OpenPDFDocIndex(index, ScriptDirectory)
<a name="l00414"></a>00414                 <span class="keywordflow">if</span> type(result) == StringType:
<a name="l00415"></a>00415                     message = wxMessageDialog(self, result, <span class="stringliteral">"ERROR"</span>, wxOK|wxICON_ERROR)
<a name="l00416"></a>00416                     message.ShowModal()
<a name="l00417"></a>00417                     message.Destroy()
<a name="l00418"></a>00418         <span class="keywordflow">if</span> <span class="keywordflow">not</span> find_index:
<a name="l00419"></a>00419             result = OpenPDFDocIndex(<span class="keywordtype">None</span>, ScriptDirectory)
<a name="l00420"></a>00420             <span class="keywordflow">if</span> type(result) == StringType:
<a name="l00421"></a>00421                 message = wxMessageDialog(self, result, <span class="stringliteral">"ERROR"</span>, wxOK|wxICON_ERROR)
<a name="l00422"></a>00422                 message.ShowModal()
<a name="l00423"></a>00423                 message.Destroy()
<a name="l00424"></a>00424         event.Skip()
<a name="l00425"></a>00425         
<a name="l00426"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#a498874fef86060832c7e90b6e028629">00426</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#a498874fef86060832c7e90b6e028629">OnHelpCANFestivalMenu</a>(self, event):
<a name="l00427"></a>00427         <span class="comment">#self.OpenHtmlFrame("CAN Festival Reference", os.path.join(ScriptDirectory, "doc/canfestival.html"), wx.Size(1000, 600))</span>
<a name="l00428"></a>00428         os.system(<span class="stringliteral">"xpdf -remote CANFESTIVAL %s %d &amp;"</span>%(os.path.join(ScriptDirectory, <span class="stringliteral">"doc/manual_en.pdf"</span>),16))
<a name="l00429"></a>00429         event.Skip()
<a name="l00430"></a>00430 
<a name="l00431"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#a660005de7e719ce7396beeea0ece661">00431</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#a660005de7e719ce7396beeea0ece661">OnAboutMenu</a>(self, event):
<a name="l00432"></a>00432         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#3779119b638995bf42810727e9562bec">OpenHtmlFrame</a>OpenHtmlFrame(<span class="stringliteral">"About CAN Festival"</span>, os.path.join(ScriptDirectory, <span class="stringliteral">"doc/about.html"</span>), wx.Size(500, 450))
<a name="l00433"></a>00433         event.Skip()
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#3779119b638995bf42810727e9562bec">00435</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#3779119b638995bf42810727e9562bec">OpenHtmlFrame</a>(self, title, file, size):
<a name="l00436"></a>00436         <span class="keywordflow">if</span> title <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#e3ce93c9ed275bf17437c681d5ad9692">HtmlFrameOpened</a>HtmlFrameOpened:
<a name="l00437"></a>00437             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#e3ce93c9ed275bf17437c681d5ad9692">HtmlFrameOpened</a>HtmlFrameOpened.append(title)
<a name="l00438"></a>00438             window = HtmlFrame(self, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#e3ce93c9ed275bf17437c681d5ad9692">HtmlFrameOpened</a>HtmlFrameOpened)
<a name="l00439"></a>00439             window.SetTitle(title)
<a name="l00440"></a>00440             window.SetHtmlPage(file)
<a name="l00441"></a>00441             window.SetClientSize(size)
<a name="l00442"></a>00442             window.Show()
<a name="l00443"></a>00443 
<a name="l00444"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#bb517a0b8fd0e43f1a1d68c7ce372ac3">00444</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#bb517a0b8fd0e43f1a1d68c7ce372ac3">OnQuitMenu</a>(self, event):
<a name="l00445"></a>00445         self.Close()
<a name="l00446"></a>00446         event.Skip()
<a name="l00447"></a>00447     
<a name="l00448"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#ef6f7560bf9be52aa312833771cfb3c9">00448</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#ef6f7560bf9be52aa312833771cfb3c9">OnCloseFrame</a>(self, event):
<a name="l00449"></a>00449         <span class="keywordflow">if</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.OneFileHasChanged():
<a name="l00450"></a>00450             dialog = wxMessageDialog(self, <span class="stringliteral">"There are changes, do you want to save?"</span>,  <span class="stringliteral">"Close Application"</span>, wxYES_NO|wxCANCEL|wxICON_QUESTION)
<a name="l00451"></a>00451             answer = dialog.ShowModal()
<a name="l00452"></a>00452             dialog.Destroy()
<a name="l00453"></a>00453             <span class="keywordflow">if</span> answer == wxID_YES:
<a name="l00454"></a>00454                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.ChangeCurrentNode(0)
<a name="l00455"></a>00455                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(self.FileOpened.GetPageCount()):
<a name="l00456"></a>00456                     <span class="keywordflow">if</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CurrentIsSaved():
<a name="l00457"></a>00457                         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CloseCurrent()
<a name="l00458"></a>00458                     <span class="keywordflow">else</span>:
<a name="l00459"></a>00459                         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#017884a8631f8a0bdfe3d37a941c196c">Save</a>Save()
<a name="l00460"></a>00460                         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CloseCurrent(<span class="keyword">True</span>)
<a name="l00461"></a>00461                 event.Skip()
<a name="l00462"></a>00462             <span class="keywordflow">elif</span> answer == wxID_NO:
<a name="l00463"></a>00463                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(self.FileOpened.GetPageCount()):
<a name="l00464"></a>00464                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CloseCurrent(<span class="keyword">True</span>)
<a name="l00465"></a>00465                 wxCallAfter(self.Close)
<a name="l00466"></a>00466                 event.Skip()
<a name="l00467"></a>00467         <span class="keywordflow">else</span>:
<a name="l00468"></a>00468             event.Skip()
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00471"></a>00471 <span class="comment">#                             Refresh Functions</span>
<a name="l00472"></a>00472 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00473"></a>00473 
<a name="l00474"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#ae8f91209a1bc14a0b7b7b62475d7f59">00474</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#ae8f91209a1bc14a0b7b7b62475d7f59">RefreshTitle</a>(self):
<a name="l00475"></a>00475         <span class="keywordflow">if</span> self.FileOpened.GetPageCount() &gt; 0:
<a name="l00476"></a>00476             self.SetTitle(<span class="stringliteral">"Objdictedit - %s"</span>%self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentFilename())
<a name="l00477"></a>00477         <span class="keywordflow">else</span>:
<a name="l00478"></a>00478             self.SetTitle(<span class="stringliteral">"Objdictedit"</span>)
<a name="l00479"></a>00479 
<a name="l00480"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#88ca3cd196a27f86a3253599b588ee4c">00480</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#88ca3cd196a27f86a3253599b588ee4c">OnRefreshMenu</a>(self, event):
<a name="l00481"></a>00481         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00482"></a>00482         event.Skip()
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">00484</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>(self):
<a name="l00485"></a>00485         selected = self.FileOpened.GetSelection()
<a name="l00486"></a>00486         window = self.FileOpened.GetPage(selected)
<a name="l00487"></a>00487         window.RefreshIndexList()
<a name="l00488"></a>00488 
<a name="l00489"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#91f233bc35906db726537b4dc4a51d28">00489</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#91f233bc35906db726537b4dc4a51d28">RefreshStatusBar</a>(self):
<a name="l00490"></a>00490         <span class="keywordflow">if</span> self.HelpBar:
<a name="l00491"></a>00491             window = self.FileOpened.GetPage(self.FileOpened.GetSelection())
<a name="l00492"></a>00492             selection = window.GetSelection()
<a name="l00493"></a>00493             <span class="keywordflow">if</span> selection:
<a name="l00494"></a>00494                 index, subIndex = selection
<a name="l00495"></a>00495                 <span class="keywordflow">if</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.IsCurrentEntry(index):
<a name="l00496"></a>00496                     self.HelpBar.SetStatusText(<span class="stringliteral">"Index: 0x%04X"</span>%index, 0)
<a name="l00497"></a>00497                     self.HelpBar.SetStatusText(<span class="stringliteral">"Subindex: 0x%02X"</span>%subIndex, 1)
<a name="l00498"></a>00498                     entryinfos = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetEntryInfos(index)
<a name="l00499"></a>00499                     name = entryinfos[<span class="stringliteral">"name"</span>]
<a name="l00500"></a>00500                     category = <span class="stringliteral">"Optional"</span>
<a name="l00501"></a>00501                     <span class="keywordflow">if</span> entryinfos[<span class="stringliteral">"need"</span>]:
<a name="l00502"></a>00502                         category = <span class="stringliteral">"Mandatory"</span>
<a name="l00503"></a>00503                     struct = <span class="stringliteral">"VAR"</span>
<a name="l00504"></a>00504                     number = <span class="stringliteral">""</span>
<a name="l00505"></a>00505                     <span class="keywordflow">if</span> entryinfos[<span class="stringliteral">"struct"</span>] &amp; OD_IdenticalIndexes:
<a name="l00506"></a>00506                         number = <span class="stringliteral">" possibly defined %d times"</span>%entryinfos[<span class="stringliteral">"nbmax"</span>]
<a name="l00507"></a>00507                     <span class="keywordflow">if</span> entryinfos[<span class="stringliteral">"struct"</span>] &amp; OD_IdenticalSubindexes:
<a name="l00508"></a>00508                         struct = <span class="stringliteral">"REC"</span>
<a name="l00509"></a>00509                     <span class="keywordflow">elif</span> entryinfos[<span class="stringliteral">"struct"</span>] &amp; OD_MultipleSubindexes:
<a name="l00510"></a>00510                         struct = <span class="stringliteral">"ARRAY"</span>
<a name="l00511"></a>00511                     text = <span class="stringliteral">"%s: %s entry of struct %s%s."</span>%(name,category,struct,number)
<a name="l00512"></a>00512                     self.HelpBar.SetStatusText(text, 2)
<a name="l00513"></a>00513                 <span class="keywordflow">else</span>:
<a name="l00514"></a>00514                     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(3):
<a name="l00515"></a>00515                         self.HelpBar.SetStatusText(<span class="stringliteral">""</span>, i)
<a name="l00516"></a>00516             <span class="keywordflow">else</span>:
<a name="l00517"></a>00517                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(3):
<a name="l00518"></a>00518                     self.HelpBar.SetStatusText(<span class="stringliteral">""</span>, i)
<a name="l00519"></a>00519 
<a name="l00520"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#adc9eb58dc3ff58afd5ff7451a62923d">00520</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#adc9eb58dc3ff58afd5ff7451a62923d">RefreshMainMenu</a>(self):
<a name="l00521"></a>00521         <span class="keywordflow">if</span> self.FileMenu:
<a name="l00522"></a>00522             <span class="keywordflow">if</span> self.FileOpened.GetPageCount() &gt; 0:
<a name="l00523"></a>00523                 self.menuBar1.EnableTop(1, <span class="keyword">True</span>)
<a name="l00524"></a>00524                 self.menuBar1.EnableTop(2, <span class="keyword">True</span>)
<a name="l00525"></a>00525                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS1, <span class="keyword">True</span>)
<a name="l00526"></a>00526                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS2, <span class="keyword">True</span>)
<a name="l00527"></a>00527                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS6, <span class="keyword">True</span>)
<a name="l00528"></a>00528                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS8, <span class="keyword">True</span>)
<a name="l00529"></a>00529                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS9, <span class="keyword">True</span>)
<a name="l00530"></a>00530             <span class="keywordflow">else</span>:
<a name="l00531"></a>00531                 self.menuBar1.EnableTop(1, <span class="keyword">False</span>)      
<a name="l00532"></a>00532                 self.menuBar1.EnableTop(2, <span class="keyword">False</span>)
<a name="l00533"></a>00533                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS1, <span class="keyword">False</span>)
<a name="l00534"></a>00534                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS2, <span class="keyword">False</span>)
<a name="l00535"></a>00535                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS6, <span class="keyword">False</span>)
<a name="l00536"></a>00536                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS8, <span class="keyword">False</span>)
<a name="l00537"></a>00537                 self.FileMenu.Enable(wxID_OBJDICTEDITFILEMENUITEMS9, <span class="keyword">False</span>)
<a name="l00538"></a>00538 
<a name="l00539"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#2b33b17be4ab0796b701fc916fcf7e64">00539</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#2b33b17be4ab0796b701fc916fcf7e64">RefreshEditMenu</a>(self):
<a name="l00540"></a>00540         <span class="keywordflow">if</span> self.FileMenu:
<a name="l00541"></a>00541             <span class="keywordflow">if</span> self.FileOpened.GetPageCount() &gt; 0:
<a name="l00542"></a>00542                 undo, redo = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentBufferState()
<a name="l00543"></a>00543                 self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS1, undo)
<a name="l00544"></a>00544                 self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS0, redo)
<a name="l00545"></a>00545             <span class="keywordflow">else</span>:
<a name="l00546"></a>00546                 self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS1, <span class="keyword">False</span>)
<a name="l00547"></a>00547                 self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS0, <span class="keyword">False</span>)
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">00549</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">RefreshProfileMenu</a>(self):
<a name="l00550"></a>00550         <span class="keywordflow">if</span> self.EditMenu:
<a name="l00551"></a>00551             profile = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentProfileName()
<a name="l00552"></a>00552             edititem = self.EditMenu.FindItemById(wxID_OBJDICTEDITEDITMENUITEMS7)
<a name="l00553"></a>00553             <span class="keywordflow">if</span> edititem:
<a name="l00554"></a>00554                 length = self.AddMenu.GetMenuItemCount()
<a name="l00555"></a>00555                 <span class="keywordflow">for</span> i <span class="keywordflow">in</span> xrange(length-6):
<a name="l00556"></a>00556                     additem = self.AddMenu.FindItemByPosition(6)
<a name="l00557"></a>00557                     self.AddMenu.Delete(additem.GetId())
<a name="l00558"></a>00558                 <span class="keywordflow">if</span> profile <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">"None"</span>, <span class="stringliteral">"DS-301"</span>):
<a name="l00559"></a>00559                     edititem.SetText(<span class="stringliteral">"%s Profile"</span>%profile)
<a name="l00560"></a>00560                     edititem.Enable(<span class="keyword">True</span>)
<a name="l00561"></a>00561                     self.AddMenu.AppendSeparator()
<a name="l00562"></a>00562                     <span class="keywordflow">for</span> text, indexes <span class="keywordflow">in</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentSpecificMenu():
<a name="l00563"></a>00563                         new_id = wx.NewId()
<a name="l00564"></a>00564                         self.AddMenu.Append(help=<span class="stringliteral">''</span>, id=new_id, kind=wx.ITEM_NORMAL, text=text)
<a name="l00565"></a>00565                         self.Bind(wx.EVT_MENU, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#5c7d639d93865513d3d469703fe19816">GetProfileCallBack</a>GetProfileCallBack(text), id=new_id)
<a name="l00566"></a>00566                 <span class="keywordflow">else</span>:
<a name="l00567"></a>00567                     edititem.SetText(<span class="stringliteral">"Other Profile"</span>)
<a name="l00568"></a>00568                     edititem.Enable(<span class="keyword">False</span>)
<a name="l00569"></a>00569         
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00572"></a>00572 <span class="comment">#                            Buffer Functions</span>
<a name="l00573"></a>00573 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00574"></a>00574 
<a name="l00575"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">00575</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>(self):
<a name="l00576"></a>00576         fileopened = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetAllFilenames()
<a name="l00577"></a>00577         <span class="keywordflow">for</span> idx, filename <span class="keywordflow">in</span> enumerate(fileopened):
<a name="l00578"></a>00578             self.FileOpened.SetPageText(idx, filename)
<a name="l00579"></a>00579         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#2b33b17be4ab0796b701fc916fcf7e64">RefreshEditMenu</a>RefreshEditMenu()
<a name="l00580"></a>00580         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#ae8f91209a1bc14a0b7b7b62475d7f59">RefreshTitle</a>RefreshTitle()
<a name="l00581"></a>00581 
<a name="l00582"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#264a8c0092529d669e103a0e08bfa759">00582</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#264a8c0092529d669e103a0e08bfa759">OnUndoMenu</a>(self, event):
<a name="l00583"></a>00583         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.LoadCurrentPrevious()
<a name="l00584"></a>00584         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00585"></a>00585         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00586"></a>00586         event.Skip()
<a name="l00587"></a>00587 
<a name="l00588"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#e864e63ae5efdb88512d02c0e51d895e">00588</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#e864e63ae5efdb88512d02c0e51d895e">OnRedoMenu</a>(self, event):
<a name="l00589"></a>00589         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.LoadCurrentNext()
<a name="l00590"></a>00590         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00591"></a>00591         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00592"></a>00592         event.Skip()
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00596"></a>00596 <span class="comment">#                         Load and Save Funtions</span>
<a name="l00597"></a>00597 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00598"></a>00598 
<a name="l00599"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#40237739c2edecc9ba933051404a5c61">00599</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#40237739c2edecc9ba933051404a5c61">OnNewMenu</a>(self, event):
<a name="l00600"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#d412cf4192d971441e15328fe07d0836">00600</a>         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d412cf4192d971441e15328fe07d0836">FilePath</a>FilePath = <span class="stringliteral">""</span>
<a name="l00601"></a>00601         dialog = CreateNodeDialog(self, ScriptDirectory)
<a name="l00602"></a>00602         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00603"></a>00603             name, id, nodetype, description = dialog.GetValues()
<a name="l00604"></a>00604             profile, filepath = dialog.GetProfile()
<a name="l00605"></a>00605             NMT = dialog.GetNMTManagement()
<a name="l00606"></a>00606             options = dialog.GetOptions()
<a name="l00607"></a>00607             result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CreateNewNode(name, id, nodetype, description, profile, filepath, NMT, options)
<a name="l00608"></a>00608             <span class="keywordflow">if</span> type(result) == IntType:
<a name="l00609"></a>00609                 new_editingpanel = EditingPanel(self, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager)
<a name="l00610"></a>00610                 new_editingpanel.SetIndex(result)
<a name="l00611"></a>00611                 self.FileOpened.AddPage(new_editingpanel, <span class="stringliteral">""</span>)
<a name="l00612"></a>00612                 self.FileOpened.SetSelection(self.FileOpened.GetPageCount() - 1)
<a name="l00613"></a>00613                 self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS8, <span class="keyword">False</span>)
<a name="l00614"></a>00614                 <span class="keywordflow">if</span> <span class="stringliteral">"DS302"</span> <span class="keywordflow">in</span> options:
<a name="l00615"></a>00615                     self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS8, <span class="keyword">True</span>)
<a name="l00616"></a>00616                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00617"></a>00617                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">RefreshProfileMenu</a>RefreshProfileMenu()
<a name="l00618"></a>00618                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#adc9eb58dc3ff58afd5ff7451a62923d">RefreshMainMenu</a>RefreshMainMenu()
<a name="l00619"></a>00619             <span class="keywordflow">else</span>:
<a name="l00620"></a>00620                 message = wxMessageDialog(self, result, <span class="stringliteral">"ERROR"</span>, wxOK|wxICON_ERROR)
<a name="l00621"></a>00621                 message.ShowModal()
<a name="l00622"></a>00622                 message.Destroy()
<a name="l00623"></a>00623         event.Skip()
<a name="l00624"></a>00624 
<a name="l00625"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#98335ef3e9581fd3915a23d40b7f66c0">00625</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#98335ef3e9581fd3915a23d40b7f66c0">OnOpenMenu</a>(self, event):
<a name="l00626"></a>00626         filepath = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentFilePath()
<a name="l00627"></a>00627         <span class="keywordflow">if</span> filepath != <span class="stringliteral">""</span>:
<a name="l00628"></a>00628             directory = os.path.dirname(filepath)
<a name="l00629"></a>00629         <span class="keywordflow">else</span>:
<a name="l00630"></a>00630             directory = os.getcwd()
<a name="l00631"></a>00631         dialog = wxFileDialog(self, <span class="stringliteral">"Choose a file"</span>, directory, <span class="stringliteral">""</span>,  <span class="stringliteral">"OD files (*.od)|*.od|All files|*.*"</span>, wxOPEN|wxCHANGE_DIR)
<a name="l00632"></a>00632         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00633"></a>00633             filepath = dialog.GetPath()
<a name="l00634"></a>00634             <span class="keywordflow">if</span> os.path.isfile(filepath):
<a name="l00635"></a>00635                 result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.OpenFileInCurrent(filepath)
<a name="l00636"></a>00636                 <span class="keywordflow">if</span> type(result) == IntType:
<a name="l00637"></a>00637                     new_editingpanel = EditingPanel(self, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager)
<a name="l00638"></a>00638                     new_editingpanel.SetIndex(result)
<a name="l00639"></a>00639                     self.FileOpened.AddPage(new_editingpanel, <span class="stringliteral">""</span>)
<a name="l00640"></a>00640                     self.FileOpened.SetSelection(self.FileOpened.GetPageCount() - 1)
<a name="l00641"></a>00641                     <span class="keywordflow">if</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CurrentDS302Defined(): 
<a name="l00642"></a>00642                         self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS8, <span class="keyword">True</span>)
<a name="l00643"></a>00643                     <span class="keywordflow">else</span>:
<a name="l00644"></a>00644                         self.EditMenu.Enable(wxID_OBJDICTEDITEDITMENUITEMS8, <span class="keyword">False</span>)
<a name="l00645"></a>00645                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#2b33b17be4ab0796b701fc916fcf7e64">RefreshEditMenu</a>RefreshEditMenu()
<a name="l00646"></a>00646                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00647"></a>00647                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">RefreshProfileMenu</a>RefreshProfileMenu()
<a name="l00648"></a>00648                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#adc9eb58dc3ff58afd5ff7451a62923d">RefreshMainMenu</a>RefreshMainMenu()
<a name="l00649"></a>00649                 <span class="keywordflow">else</span>:
<a name="l00650"></a>00650                     message = wxMessageDialog(self, e.args[0], <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00651"></a>00651                     message.ShowModal()
<a name="l00652"></a>00652                     message.Destroy()
<a name="l00653"></a>00653         dialog.Destroy()
<a name="l00654"></a>00654         event.Skip()
<a name="l00655"></a>00655 
<a name="l00656"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#4ec2a606f003b9428515bc47a63f549b">00656</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#4ec2a606f003b9428515bc47a63f549b">OnSaveMenu</a>(self, event):
<a name="l00657"></a>00657         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#017884a8631f8a0bdfe3d37a941c196c">Save</a>Save()
<a name="l00658"></a>00658         event.Skip()
<a name="l00659"></a>00659     
<a name="l00660"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#4120aa522383dd8fe88df46672e1464c">00660</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#4120aa522383dd8fe88df46672e1464c">OnSaveAsMenu</a>(self, event):
<a name="l00661"></a>00661         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#67eeca8c238cfd33c1d8e8fb33f07a5c">SaveAs</a>SaveAs()
<a name="l00662"></a>00662         event.Skip()
<a name="l00663"></a>00663         
<a name="l00664"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#017884a8631f8a0bdfe3d37a941c196c">00664</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#017884a8631f8a0bdfe3d37a941c196c">Save</a>(self):
<a name="l00665"></a>00665         result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.SaveCurrentInFile()
<a name="l00666"></a>00666         <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00667"></a>00667             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#67eeca8c238cfd33c1d8e8fb33f07a5c">SaveAs</a>SaveAs()
<a name="l00668"></a>00668         <span class="keywordflow">elif</span> type(result) != StringType:
<a name="l00669"></a>00669             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00670"></a>00670         <span class="keywordflow">else</span>:
<a name="l00671"></a>00671             message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00672"></a>00672             message.ShowModal()
<a name="l00673"></a>00673             message.Destroy()
<a name="l00674"></a>00674 
<a name="l00675"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#67eeca8c238cfd33c1d8e8fb33f07a5c">00675</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#67eeca8c238cfd33c1d8e8fb33f07a5c">SaveAs</a>(self):
<a name="l00676"></a>00676         filepath = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentFilePath()
<a name="l00677"></a>00677         <span class="keywordflow">if</span> filepath != <span class="stringliteral">""</span>:
<a name="l00678"></a>00678             directory, filename = os.path.split(filepath)
<a name="l00679"></a>00679         <span class="keywordflow">else</span>:
<a name="l00680"></a>00680             directory, filename = os.getcwd(), <span class="stringliteral">"%s.od"</span>%self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentNodeInfos()[0]
<a name="l00681"></a>00681         dialog = wxFileDialog(self, <span class="stringliteral">"Choose a file"</span>, directory, filename,  <span class="stringliteral">"OD files (*.od)|*.od|All files|*.*"</span>, wxSAVE|wxOVERWRITE_PROMPT|wxCHANGE_DIR)
<a name="l00682"></a>00682         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00683"></a>00683             filepath = dialog.GetPath()
<a name="l00684"></a>00684             <span class="keywordflow">if</span> os.path.isdir(os.path.dirname(filepath)):
<a name="l00685"></a>00685                 result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.SaveCurrentInFile(filepath)
<a name="l00686"></a>00686                 <span class="keywordflow">if</span> type(result) != StringType:
<a name="l00687"></a>00687                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00688"></a>00688                 <span class="keywordflow">else</span>:
<a name="l00689"></a>00689                     message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00690"></a>00690                     message.ShowModal()
<a name="l00691"></a>00691                     message.Destroy()
<a name="l00692"></a>00692             <span class="keywordflow">else</span>:
<a name="l00693"></a>00693                 message = wxMessageDialog(self, <span class="stringliteral">"%s is not a valid folder!"</span>%os.path.dirname(filepath), <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00694"></a>00694                 message.ShowModal()
<a name="l00695"></a>00695                 message.Destroy()
<a name="l00696"></a>00696         dialog.Destroy()
<a name="l00697"></a>00697 
<a name="l00698"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#a4c7476aa37450fef74c824201044c3b">00698</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#a4c7476aa37450fef74c824201044c3b">OnCloseMenu</a>(self, event):
<a name="l00699"></a>00699         answer = wxID_YES
<a name="l00700"></a>00700         result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CloseCurrent()
<a name="l00701"></a>00701         <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00702"></a>00702             dialog = wxMessageDialog(self, <span class="stringliteral">"There are changes, do you want to save?"</span>,  <span class="stringliteral">"Close File"</span>, wxYES_NO|wxCANCEL|wxICON_QUESTION)
<a name="l00703"></a>00703             answer = dialog.ShowModal()
<a name="l00704"></a>00704             dialog.Destroy()
<a name="l00705"></a>00705             <span class="keywordflow">if</span> answer == wxID_YES:
<a name="l00706"></a>00706                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#4ec2a606f003b9428515bc47a63f549b">OnSaveMenu</a>OnSaveMenu(event)
<a name="l00707"></a>00707                 <span class="keywordflow">if</span> self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CurrentIsSaved():
<a name="l00708"></a>00708                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CloseCurrent()
<a name="l00709"></a>00709             <span class="keywordflow">elif</span> answer == wxID_NO:
<a name="l00710"></a>00710                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.CloseCurrent(<span class="keyword">True</span>)
<a name="l00711"></a>00711         <span class="keywordflow">if</span> self.FileOpened.GetPageCount() &gt; self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetBufferNumber():
<a name="l00712"></a>00712             current = self.FileOpened.GetSelection()
<a name="l00713"></a>00713             self.FileOpened.DeletePage(current)
<a name="l00714"></a>00714             <span class="keywordflow">if</span> self.FileOpened.GetPageCount() &gt; 0:
<a name="l00715"></a>00715                 self.FileOpened.SetSelection(min(current, self.FileOpened.GetPageCount() - 1))
<a name="l00716"></a>00716             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00717"></a>00717             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#adc9eb58dc3ff58afd5ff7451a62923d">RefreshMainMenu</a>RefreshMainMenu()
<a name="l00718"></a>00718         event.Skip()
<a name="l00719"></a>00719         
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00722"></a>00722 <span class="comment">#                         Import and Export Functions</span>
<a name="l00723"></a>00723 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00724"></a>00724 
<a name="l00725"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#8382d1464dd6a162f97040adc166251e">00725</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#8382d1464dd6a162f97040adc166251e">OnImportEDSMenu</a>(self, event):
<a name="l00726"></a>00726         dialog = wxFileDialog(self, <span class="stringliteral">"Choose a file"</span>, os.getcwd(), <span class="stringliteral">""</span>,  <span class="stringliteral">"EDS files (*.eds)|*.eds|All files|*.*"</span>, wxOPEN|wxCHANGE_DIR)
<a name="l00727"></a>00727         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00728"></a>00728             filepath = dialog.GetPath()
<a name="l00729"></a>00729             <span class="keywordflow">if</span> os.path.isfile(filepath):
<a name="l00730"></a>00730                 result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.ImportCurrentFromEDSFile(filepath)
<a name="l00731"></a>00731                 <span class="keywordflow">if</span> type(result) == IntType:
<a name="l00732"></a>00732                     new_editingpanel = EditingPanel(self, self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager)
<a name="l00733"></a>00733                     new_editingpanel.SetIndex(result)
<a name="l00734"></a>00734                     self.FileOpened.AddPage(new_editingpanel, <span class="stringliteral">""</span>)
<a name="l00735"></a>00735                     self.FileOpened.SetSelection(self.FileOpened.GetPageCount() - 1)
<a name="l00736"></a>00736                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00737"></a>00737                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00738"></a>00738                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">RefreshProfileMenu</a>RefreshProfileMenu()
<a name="l00739"></a>00739                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#adc9eb58dc3ff58afd5ff7451a62923d">RefreshMainMenu</a>RefreshMainMenu()
<a name="l00740"></a>00740                     message = wxMessageDialog(self, <span class="stringliteral">"Import successful"</span>, <span class="stringliteral">"Information"</span>, wxOK|wxICON_INFORMATION)
<a name="l00741"></a>00741                     message.ShowModal()
<a name="l00742"></a>00742                     message.Destroy()
<a name="l00743"></a>00743                 <span class="keywordflow">else</span>:
<a name="l00744"></a>00744                     message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00745"></a>00745                     message.ShowModal()
<a name="l00746"></a>00746                     message.Destroy()
<a name="l00747"></a>00747             <span class="keywordflow">else</span>:
<a name="l00748"></a>00748                 message = wxMessageDialog(self, <span class="stringliteral">"\"%s\" is not a valid file!"</span>%filepath, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00749"></a>00749                 message.ShowModal()
<a name="l00750"></a>00750                 message.Destroy()
<a name="l00751"></a>00751         dialog.Destroy()
<a name="l00752"></a>00752         event.Skip()
<a name="l00753"></a>00753 
<a name="l00754"></a>00754 
<a name="l00755"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#29636fcd3f8f738404b6b99f93f04490">00755</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#29636fcd3f8f738404b6b99f93f04490">OnExportEDSMenu</a>(self, event):
<a name="l00756"></a>00756         dialog = wxFileDialog(self, <span class="stringliteral">"Choose a file"</span>, os.getcwd(), self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentNodeInfos()[0], <span class="stringliteral">"EDS files (*.eds)|*.eds|All files|*.*"</span>, wxSAVE|wxOVERWRITE_PROMPT|wxCHANGE_DIR)
<a name="l00757"></a>00757         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00758"></a>00758             filepath = dialog.GetPath()
<a name="l00759"></a>00759             <span class="keywordflow">if</span> os.path.isdir(os.path.dirname(filepath)):
<a name="l00760"></a>00760                 path, extend = os.path.splitext(filepath)
<a name="l00761"></a>00761                 <span class="keywordflow">if</span> extend <span class="keywordflow">in</span> (<span class="stringliteral">""</span>, <span class="stringliteral">"."</span>):
<a name="l00762"></a>00762                     filepath = path + <span class="stringliteral">".eds"</span>
<a name="l00763"></a>00763                 result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.ExportCurrentToEDSFile(filepath)
<a name="l00764"></a>00764                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00765"></a>00765                     message = wxMessageDialog(self, <span class="stringliteral">"Export successful"</span>, <span class="stringliteral">"Information"</span>, wxOK|wxICON_INFORMATION)
<a name="l00766"></a>00766                     message.ShowModal()
<a name="l00767"></a>00767                     message.Destroy()
<a name="l00768"></a>00768                 <span class="keywordflow">else</span>:
<a name="l00769"></a>00769                     message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00770"></a>00770                     message.ShowModal()
<a name="l00771"></a>00771                     message.Destroy()
<a name="l00772"></a>00772             <span class="keywordflow">else</span>:
<a name="l00773"></a>00773                 message = wxMessageDialog(self, <span class="stringliteral">"\"%s\" is not a valid folder!"</span>%os.path.dirname(filepath), <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00774"></a>00774                 message.ShowModal()
<a name="l00775"></a>00775                 message.Destroy()
<a name="l00776"></a>00776         dialog.Destroy()
<a name="l00777"></a>00777         event.Skip()
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#bf3d84bab96fcc04254a602c33fbbbee">00779</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#bf3d84bab96fcc04254a602c33fbbbee">OnExportCMenu</a>(self, event):
<a name="l00780"></a>00780         dialog = wxFileDialog(self, <span class="stringliteral">"Choose a file"</span>, os.getcwd(), self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentNodeInfos()[0],  <span class="stringliteral">"CANFestival OD files (*.c)|*.c|All files|*.*"</span>, wxSAVE|wxOVERWRITE_PROMPT|wxCHANGE_DIR)
<a name="l00781"></a>00781         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00782"></a>00782             filepath = dialog.GetPath()
<a name="l00783"></a>00783             <span class="keywordflow">if</span> os.path.isdir(os.path.dirname(filepath)):
<a name="l00784"></a>00784                 path, extend = os.path.splitext(filepath)
<a name="l00785"></a>00785                 <span class="keywordflow">if</span> extend <span class="keywordflow">in</span> (<span class="stringliteral">""</span>, <span class="stringliteral">"."</span>):
<a name="l00786"></a>00786                     filepath = path + <span class="stringliteral">".c"</span>
<a name="l00787"></a>00787                 result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.ExportCurrentToCFile(filepath)
<a name="l00788"></a>00788                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00789"></a>00789                     message = wxMessageDialog(self, <span class="stringliteral">"Export successful"</span>, <span class="stringliteral">"Information"</span>, wxOK|wxICON_INFORMATION)
<a name="l00790"></a>00790                     message.ShowModal()
<a name="l00791"></a>00791                     message.Destroy()
<a name="l00792"></a>00792                 <span class="keywordflow">else</span>:
<a name="l00793"></a>00793                     message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00794"></a>00794                     message.ShowModal()
<a name="l00795"></a>00795                     message.Destroy()
<a name="l00796"></a>00796             <span class="keywordflow">else</span>:
<a name="l00797"></a>00797                 message = wxMessageDialog(self, <span class="stringliteral">"\"%s\" is not a valid folder!"</span>%os.path.dirname(filepath), <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00798"></a>00798                 message.ShowModal()
<a name="l00799"></a>00799                 message.Destroy()
<a name="l00800"></a>00800         dialog.Destroy()
<a name="l00801"></a>00801         event.Skip()
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00804"></a>00804 <span class="comment">#                          Editing Profiles functions</span>
<a name="l00805"></a>00805 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00806"></a>00806 
<a name="l00807"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#e1addc8fb2f5922f54e3e7805ed5d33e">00807</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#e1addc8fb2f5922f54e3e7805ed5d33e">OnCommunicationMenu</a>(self, event):
<a name="l00808"></a>00808         dictionary,current = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentCommunicationLists()
<a name="l00809"></a>00809         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#0c0a3c1a47120a21ae3d4080c644ea0f">EditProfile</a>EditProfile(<span class="stringliteral">"Edit DS-301 Profile"</span>, dictionary, current)
<a name="l00810"></a>00810         event.Skip()
<a name="l00811"></a>00811     
<a name="l00812"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#01f0b410972b6c480f6eac6448aca0e6">00812</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#01f0b410972b6c480f6eac6448aca0e6">OnOtherCommunicationMenu</a>(self, event):
<a name="l00813"></a>00813         dictionary,current = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentDS302Lists()
<a name="l00814"></a>00814         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#0c0a3c1a47120a21ae3d4080c644ea0f">EditProfile</a>EditProfile(<span class="stringliteral">"Edit DS-301 Profile"</span>, dictionary, current)
<a name="l00815"></a>00815         event.Skip()
<a name="l00816"></a>00816     
<a name="l00817"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#e807650522769539794ab076713098e2">00817</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#e807650522769539794ab076713098e2">OnEditProfileMenu</a>(self, event):
<a name="l00818"></a>00818         title = <span class="stringliteral">"Edit %s Profile"</span>%self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentProfileName()
<a name="l00819"></a>00819         dictionary,current = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentProfileLists()
<a name="l00820"></a>00820         self.<a class="code" href="classobjdictedit_1_1objdictedit.html#0c0a3c1a47120a21ae3d4080c644ea0f">EditProfile</a>EditProfile(title, dictionary, current)
<a name="l00821"></a>00821         event.Skip()
<a name="l00822"></a>00822     
<a name="l00823"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#0c0a3c1a47120a21ae3d4080c644ea0f">00823</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#0c0a3c1a47120a21ae3d4080c644ea0f">EditProfile</a>(self, title, dictionary, current):
<a name="l00824"></a>00824         dialog = CommunicationDialog(self)
<a name="l00825"></a>00825         dialog.SetTitle(title)
<a name="l00826"></a>00826         dialog.SetIndexDictionary(dictionary)
<a name="l00827"></a>00827         dialog.SetCurrentList(current)
<a name="l00828"></a>00828         dialog.RefreshLists()
<a name="l00829"></a>00829         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00830"></a>00830             new_profile = dialog.GetCurrentList()
<a name="l00831"></a>00831             addinglist = []
<a name="l00832"></a>00832             removinglist = []
<a name="l00833"></a>00833             <span class="keywordflow">for</span> index <span class="keywordflow">in</span> new_profile:
<a name="l00834"></a>00834                 <span class="keywordflow">if</span> index <span class="keywordflow">not</span> <span class="keywordflow">in</span> current:
<a name="l00835"></a>00835                     addinglist.append(index)
<a name="l00836"></a>00836             <span class="keywordflow">for</span> index <span class="keywordflow">in</span> current:
<a name="l00837"></a>00837                 <span class="keywordflow">if</span> index <span class="keywordflow">not</span> <span class="keywordflow">in</span> new_profile:
<a name="l00838"></a>00838                     removinglist.append(index)
<a name="l00839"></a>00839             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.ManageEntriesOfCurrent(addinglist, removinglist)
<a name="l00840"></a>00840             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GenerateMapList()
<a name="l00841"></a>00841             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.BufferCurrentNode()
<a name="l00842"></a>00842             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00843"></a>00843             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00844"></a>00844         dialog.Destroy()
<a name="l00845"></a>00845 
<a name="l00846"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#5c7d639d93865513d3d469703fe19816">00846</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#5c7d639d93865513d3d469703fe19816">GetProfileCallBack</a>(self, text):
<a name="l00847"></a>00847         <span class="keyword">def </span>ProfileCallBack(event):
<a name="l00848"></a>00848             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.AddSpecificEntryToCurrent(text)
<a name="l00849"></a>00849             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00850"></a>00850             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00851"></a>00851             event.Skip()
<a name="l00852"></a>00852         <span class="keywordflow">return</span> ProfileCallBack
<a name="l00853"></a>00853 
<a name="l00854"></a>00854 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00855"></a>00855 <span class="comment">#                         Edit Node informations function</span>
<a name="l00856"></a>00856 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00857"></a>00857 
<a name="l00858"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#3bc819e548d22a2487aa70a0f3e6cbb4">00858</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#3bc819e548d22a2487aa70a0f3e6cbb4">OnNodeInfosMenu</a>(self, event):
<a name="l00859"></a>00859         dialog = NodeInfosDialog(self)
<a name="l00860"></a>00860         name, id, type, description = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentNodeInfos()
<a name="l00861"></a>00861         dialog.SetValues(name, id, type, description)
<a name="l00862"></a>00862         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00863"></a>00863             name, id, type, description = dialog.GetValues()
<a name="l00864"></a>00864             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.SetCurrentNodeInfos(name, id, type, description)
<a name="l00865"></a>00865             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00866"></a>00866             self.<a class="code" href="classobjdictedit_1_1objdictedit.html#d9fcd386d41eff2b5f7475c7c4e2e501">RefreshProfileMenu</a>RefreshProfileMenu()
<a name="l00867"></a>00867             selected = self.FileOpened.GetSelection()
<a name="l00868"></a>00868             <span class="keywordflow">if</span> selected &gt;= 0:
<a name="l00869"></a>00869                 window = self.FileOpened.GetPage(selected)
<a name="l00870"></a>00870                 window.RefreshTable()
<a name="l00871"></a>00871         event.Skip()
<a name="l00872"></a>00872 
<a name="l00873"></a>00873 
<a name="l00874"></a>00874 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00875"></a>00875 <span class="comment">#                           Add User Types and Variables</span>
<a name="l00876"></a>00876 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00877"></a>00877         
<a name="l00878"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#d320c07fd4feab969b9454d49ab0ef5a">00878</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#d320c07fd4feab969b9454d49ab0ef5a">AddMapVariable</a>(self):
<a name="l00879"></a>00879         index = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCurrentNextMapIndex()
<a name="l00880"></a>00880         <span class="keywordflow">if</span> index:
<a name="l00881"></a>00881             dialog = MapVariableDialog(self)
<a name="l00882"></a>00882             dialog.SetIndex(index)
<a name="l00883"></a>00883             <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00884"></a>00884                 index, name, struct, number = dialog.GetValues()
<a name="l00885"></a>00885                 result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.AddMapVariableToCurrent(index, name, struct, number)
<a name="l00886"></a>00886                 <span class="keywordflow">if</span> type(result) != StringType:
<a name="l00887"></a>00887                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00888"></a>00888                     self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00889"></a>00889                 <span class="keywordflow">else</span>:
<a name="l00890"></a>00890                     message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00891"></a>00891                     message.ShowModal()
<a name="l00892"></a>00892                     message.Destroy()
<a name="l00893"></a>00893             dialog.Destroy()
<a name="l00894"></a>00894         <span class="keywordflow">else</span>:
<a name="l00895"></a>00895             message = wxMessageDialog(self, result, <span class="stringliteral">"No map variable index left!"</span>, wxOK|wxICON_ERROR)
<a name="l00896"></a>00896             message.ShowModal()
<a name="l00897"></a>00897             message.Destroy()
<a name="l00898"></a>00898         
<a name="l00899"></a><a class="code" href="classobjdictedit_1_1objdictedit.html#704a2250995855aaabdd9e024e98a1ca">00899</a>     <span class="keyword">def </span><a class="code" href="classobjdictedit_1_1objdictedit.html#704a2250995855aaabdd9e024e98a1ca">AddUserType</a>(self):
<a name="l00900"></a>00900         dialog = UserTypeDialog(self)
<a name="l00901"></a>00901         dialog.SetTypeList(self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.GetCustomisableTypes())
<a name="l00902"></a>00902         <span class="keywordflow">if</span> dialog.ShowModal() == wxID_OK:
<a name="l00903"></a>00903             type, min, max, length = dialog.GetValues()
<a name="l00904"></a>00904             result = self.<a class="code" href="classobjdictedit_1_1objdictedit.html#6ccd1cd8d15a57827a655e8e556550aa">Manager</a>Manager.AddUserTypeToCurrent(type, min, max, length)
<a name="l00905"></a>00905             <span class="keywordflow">if</span> <span class="keywordflow">not</span> result:
<a name="l00906"></a>00906                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#be28bc389ae846a97daba676fbe064db">RefreshBufferState</a>RefreshBufferState()
<a name="l00907"></a>00907                 self.<a class="code" href="classobjdictedit_1_1objdictedit.html#555d5c79e43419d21eca542c42de567d">RefreshCurrentIndexList</a>RefreshCurrentIndexList()
<a name="l00908"></a>00908             <span class="keywordflow">else</span>:
<a name="l00909"></a>00909                 message = wxMessageDialog(self, result, <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00910"></a>00910                 message.ShowModal()
<a name="l00911"></a>00911                 message.Destroy()
<a name="l00912"></a>00912         dialog.Destroy()
<a name="l00913"></a>00913     
<a name="l00914"></a>00914 
<a name="l00915"></a>00915 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00916"></a>00916 <span class="comment">#                               Exception Handler</span>
<a name="l00917"></a>00917 <span class="comment">#-------------------------------------------------------------------------------</span>
<a name="l00918"></a>00918 
<a name="l00919"></a>00919 Max_Traceback_List_Size = 20
<a name="l00920"></a>00920 
<a name="l00921"></a><a class="code" href="namespaceobjdictedit.html#2c93a930b5594c97af560c8b245651ad">00921</a> <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#2c93a930b5594c97af560c8b245651ad">Display_Exception_Dialog</a>(e_type,e_value,e_tb):
<a name="l00922"></a>00922     trcbck_lst = []
<a name="l00923"></a>00923     <span class="keywordflow">for</span> i,line <span class="keywordflow">in</span> enumerate(traceback.extract_tb(e_tb)):
<a name="l00924"></a>00924         trcbck = <span class="stringliteral">" "</span> + str(i+1) + <span class="stringliteral">". "</span>
<a name="l00925"></a>00925         <span class="keywordflow">if</span> line[0].find(os.getcwd()) == -1:
<a name="l00926"></a>00926             trcbck += <span class="stringliteral">"file : "</span> + str(line[0]) + <span class="stringliteral">",   "</span>
<a name="l00927"></a>00927         <span class="keywordflow">else</span>:
<a name="l00928"></a>00928             trcbck += <span class="stringliteral">"file : "</span> + str(line[0][len(os.getcwd()):]) + <span class="stringliteral">",   "</span>
<a name="l00929"></a>00929         trcbck += <span class="stringliteral">"line : "</span> + str(line[1]) + <span class="stringliteral">",   "</span> + <span class="stringliteral">"function : "</span> + str(line[2])
<a name="l00930"></a>00930         trcbck_lst.append(trcbck)
<a name="l00931"></a>00931         
<a name="l00932"></a>00932     <span class="comment"># Allow clicking....</span>
<a name="l00933"></a>00933     cap = wx.Window_GetCapture()
<a name="l00934"></a>00934     <span class="keywordflow">if</span> cap:
<a name="l00935"></a>00935         cap.ReleaseMouse()
<a name="l00936"></a>00936 
<a name="l00937"></a>00937     dlg = wx.SingleChoiceDialog(<span class="keywordtype">None</span>, 
<a name="l00938"></a>00938         <span class="stringliteral">"""</span>
<a name="l00939"></a>00939 <span class="stringliteral">An error happens.</span>
<a name="l00940"></a>00940 <span class="stringliteral"></span>
<a name="l00941"></a>00941 <span class="stringliteral">Click on OK for saving an error report.</span>
<a name="l00942"></a>00942 <span class="stringliteral"></span>
<a name="l00943"></a>00943 <span class="stringliteral">Please contact LOLITech at:</span>
<a name="l00944"></a>00944 <span class="stringliteral">+33 (0)3 29 52 95 67</span>
<a name="l00945"></a>00945 <span class="stringliteral">bugs_objdictedit@lolitech.fr</span>
<a name="l00946"></a>00946 <span class="stringliteral"></span>
<a name="l00947"></a>00947 <span class="stringliteral"></span>
<a name="l00948"></a>00948 <span class="stringliteral">Error:</span>
<a name="l00949"></a>00949 <span class="stringliteral">"""</span> +
<a name="l00950"></a>00950         str(e_type) + <span class="stringliteral">" : "</span> + str(e_value), 
<a name="l00951"></a>00951         <span class="stringliteral">"Error"</span>,
<a name="l00952"></a>00952         trcbck_lst)
<a name="l00953"></a>00953     <span class="keywordflow">try</span>:
<a name="l00954"></a>00954         res = (dlg.ShowModal() == wx.ID_OK)
<a name="l00955"></a>00955     <span class="keywordflow">finally</span>:
<a name="l00956"></a>00956         dlg.Destroy()
<a name="l00957"></a>00957 
<a name="l00958"></a>00958     <span class="keywordflow">return</span> res
<a name="l00959"></a>00959 
<a name="l00960"></a><a class="code" href="namespaceobjdictedit.html#e994527ec0f61cfe371dfa80d802d4cb">00960</a> <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#e994527ec0f61cfe371dfa80d802d4cb">Display_Error_Dialog</a>(e_value):
<a name="l00961"></a>00961     message = wxMessageDialog(<span class="keywordtype">None</span>, str(e_value), <span class="stringliteral">"Error"</span>, wxOK|wxICON_ERROR)
<a name="l00962"></a>00962     message.ShowModal()
<a name="l00963"></a>00963     message.Destroy()
<a name="l00964"></a>00964 
<a name="l00965"></a><a class="code" href="namespaceobjdictedit.html#54964903be300a8ce9ee85eb67d5956e">00965</a> <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#54964903be300a8ce9ee85eb67d5956e">get_last_traceback</a>(tb):
<a name="l00966"></a>00966     <span class="keywordflow">while</span> tb.tb_next:
<a name="l00967"></a>00967         tb = tb.tb_next
<a name="l00968"></a>00968     <span class="keywordflow">return</span> tb
<a name="l00969"></a>00969 
<a name="l00970"></a>00970 
<a name="l00971"></a><a class="code" href="namespaceobjdictedit.html#929d463a75220fa2964868f9495a944e">00971</a> <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#929d463a75220fa2964868f9495a944e">format_namespace</a>(d, indent='    '):
<a name="l00972"></a>00972     <span class="keywordflow">return</span> <span class="stringliteral">'\n'</span>.join([<span class="stringliteral">'%s%s: %s'</span> % (indent, k, repr(v)[:10000]) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> d.iteritems()])
<a name="l00973"></a>00973 
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 ignored_exceptions = [] <span class="comment"># a problem with a line in a module is only reported once per session</span>
<a name="l00976"></a>00976 
<a name="l00977"></a><a class="code" href="namespaceobjdictedit.html#7a105b1694af4346e8de2a012657d49f">00977</a> <span class="keyword">def </span><a class="code" href="namespaceobjdictedit.html#7a105b1694af4346e8de2a012657d49f">wxAddExceptHook</a>(path, app_version='[No version]'):<span class="comment">#, ignored_exceptions=[]):</span>
<a name="l00978"></a>00978     
<a name="l00979"></a>00979     <span class="keyword">def </span>handle_exception(e_type, e_value, e_traceback):
<a name="l00980"></a>00980         traceback.print_exception(e_type, e_value, e_traceback) <span class="comment"># this is very helpful when there's an exception in the rest of this func</span>
<a name="l00981"></a>00981         last_tb = get_last_traceback(e_traceback)
<a name="l00982"></a>00982         ex = (last_tb.tb_frame.f_code.co_filename, last_tb.tb_frame.f_lineno)
<a name="l00983"></a>00983         <span class="keywordflow">if</span> str(e_value).startswith(<span class="stringliteral">"!!!"</span>):
<a name="l00984"></a>00984             Display_Error_Dialog(e_value)
<a name="l00985"></a>00985         <span class="keywordflow">elif</span> ex <span class="keywordflow">not</span> <span class="keywordflow">in</span> ignored_exceptions:
<a name="l00986"></a>00986             ignored_exceptions.append(ex)
<a name="l00987"></a>00987             result = Display_Exception_Dialog(e_type,e_value,e_traceback)
<a name="l00988"></a>00988             <span class="keywordflow">if</span> result:
<a name="l00989"></a>00989                 info = {
<a name="l00990"></a>00990                     <span class="stringliteral">'app-title'</span> : wx.GetApp().GetAppName(), <span class="comment"># app_title</span>
<a name="l00991"></a>00991                     <span class="stringliteral">'app-version'</span> : app_version,
<a name="l00992"></a>00992                     <span class="stringliteral">'wx-version'</span> : wx.VERSION_STRING,
<a name="l00993"></a>00993                     <span class="stringliteral">'wx-platform'</span> : wx.Platform,
<a name="l00994"></a>00994                     <span class="stringliteral">'python-version'</span> : platform.python_version(), <span class="comment">#sys.version.split()[0],</span>
<a name="l00995"></a>00995                     <span class="stringliteral">'platform'</span> : platform.platform(),
<a name="l00996"></a>00996                     <span class="stringliteral">'e-type'</span> : e_type,
<a name="l00997"></a>00997                     <span class="stringliteral">'e-value'</span> : e_value,
<a name="l00998"></a>00998                     <span class="stringliteral">'date'</span> : time.ctime(),
<a name="l00999"></a>00999                     <span class="stringliteral">'cwd'</span> : os.getcwd(),
<a name="l01000"></a>01000                     }
<a name="l01001"></a>01001                 <span class="keywordflow">if</span> e_traceback:
<a name="l01002"></a>01002                     info[<span class="stringliteral">'traceback'</span>] = <span class="stringliteral">''</span>.join(traceback.format_tb(e_traceback)) + <span class="stringliteral">'%s: %s'</span> % (e_type, e_value)
<a name="l01003"></a>01003                     last_tb = get_last_traceback(e_traceback)
<a name="l01004"></a>01004                     exception_locals = last_tb.tb_frame.f_locals <span class="comment"># the locals at the level of the stack trace where the exception actually occurred</span>
<a name="l01005"></a>01005                     info[<span class="stringliteral">'locals'</span>] = format_namespace(exception_locals)
<a name="l01006"></a>01006                     <span class="keywordflow">if</span> <span class="stringliteral">'self'</span> <span class="keywordflow">in</span> exception_locals:
<a name="l01007"></a>01007                         info[<span class="stringliteral">'self'</span>] = format_namespace(exception_locals[<span class="stringliteral">'self'</span>].__dict__)
<a name="l01008"></a>01008                 
<a name="l01009"></a>01009                 output = open(path+os.sep+<span class="stringliteral">"bug_report_"</span>+info[<span class="stringliteral">'date'</span>].replace(<span class="stringliteral">':'</span>,<span class="stringliteral">'-'</span>).replace(<span class="stringliteral">' '</span>,<span class="stringliteral">'_'</span>)+<span class="stringliteral">".txt"</span>,<span class="stringliteral">'w'</span>)
<a name="l01010"></a>01010                 lst = info.keys()
<a name="l01011"></a>01011                 lst.sort()
<a name="l01012"></a>01012                 <span class="keywordflow">for</span> a <span class="keywordflow">in</span> lst:
<a name="l01013"></a>01013                     output.write(a+<span class="stringliteral">":\n"</span>+str(info[a])+<span class="stringliteral">"\n\n"</span>)
<a name="l01014"></a>01014 
<a name="l01015"></a>01015     <span class="comment">#sys.excepthook = lambda *args: wx.CallAfter(handle_exception, *args)</span>
<a name="l01016"></a>01016     sys.excepthook = handle_exception
<a name="l01017"></a>01017 
<a name="l01018"></a>01018 <span class="keywordflow">if</span> __name__ == <span class="stringliteral">'__main__'</span>:
<a name="l01019"></a>01019     app = wxPySimpleApp()
<a name="l01020"></a>01020     wxInitAllImageHandlers()
<a name="l01021"></a>01021     
<a name="l01022"></a>01022     <span class="comment"># Install a exception handle for bug reports</span>
<a name="l01023"></a>01023     wxAddExceptHook(os.getcwd(),__version__)
<a name="l01024"></a>01024     
<a name="l01025"></a>01025     frame = objdictedit(<span class="keywordtype">None</span>)
<a name="l01026"></a>01026 
<a name="l01027"></a>01027     frame.Show()
<a name="l01028"></a>01028     app.MainLoop()
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 4 16:29:06 2007 for CanFestival by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
